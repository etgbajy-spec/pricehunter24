<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Content Security Policy - Firebase iframe í—ˆìš© -->
    <meta http-equiv="Content-Security-Policy" content="frame-src 'self' https://www.google.com https://recaptcha.google.com https://kauth.kakao.com https://pricehunter-99a1b.firebaseapp.com https://*.firebaseapp.com https://*.googleapis.com;" />
    
    <title>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - PriceHunter</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EğŸ”%3C/text%3E%3C/svg%3E">
    
    <!-- Firebase v9 SDK (ëª¨ë“ˆì‹) -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
      import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
      import { getFirestore, collection, query, orderBy, onSnapshot, getDocs, addDoc, serverTimestamp, doc, updateDoc, deleteDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';
      
      // Firebase ì„¤ì •
      const firebaseConfig = {
        apiKey: "AIzaSyDBZxKyMS7eeBTbPnbZkj0WWOZQHNldoL4",
        authDomain: "pricehunter-99a1b.firebaseapp.com",
        projectId: "pricehunter-99a1b",
        storageBucket: "pricehunter-99a1b.firebasestorage.app",
        messagingSenderId: "242265693919",
        appId: "1:242265693919:web:74234d942b82a51541136a",
        measurementId: "G-4BKLV4EVB9"
      };

      // Firebase ì´ˆê¸°í™”
      try {
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ì „ì—­ìœ¼ë¡œ ë…¸ì¶œ
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseAuthFunctions = { onAuthStateChanged };
        window.firebaseFirestoreFunctions = { collection, query, orderBy, onSnapshot, getDocs, addDoc, serverTimestamp, doc, updateDoc, deleteDoc };
        
        console.log('âœ… ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ Firebase v9 ì´ˆê¸°í™” ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        // ì´ˆê¸°í™” ì‹¤íŒ¨ì‹œì—ë„ ê¸°ë³¸ ê°ì²´ë“¤ì„ ìƒì„±í•˜ì—¬ ì˜¤ë¥˜ ë°©ì§€
        window.firebaseApp = null;
        window.firebaseAuth = null;
        window.firebaseDb = null;
        window.firebaseAuthFunctions = { onAuthStateChanged: () => {} };
        window.firebaseFirestoreFunctions = { 
          collection: () => {}, 
          query: () => {}, 
          orderBy: () => {}, 
          onSnapshot: () => {},
          getDocs: () => {},
          addDoc: () => {},
          serverTimestamp: () => {},
          doc: () => {},
          updateDoc: () => {},
          deleteDoc: () => {}
        };
        
        // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
        alert('Firebase ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
      }
    </script>
    
    
    <!-- Tailwind CSS (ê°œì„ ëœ ë¡œë”© ë°©ì‹) -->
    <script>
        // Tailwind CSS ì„¤ì • - CSP ì˜¤ë¥˜ ë°©ì§€
        if (typeof tailwind !== 'undefined') {
            tailwind.config = {
                theme: {
                    extend: {}
                },
                corePlugins: {
                    preflight: false
                }
            }
        }
        
        // Tailwind CSS ë™ì  ë¡œë”©
        function loadTailwindCSS() {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = 'https://cdn.tailwindcss.com';
                script.onload = () => {
                    console.log('âœ… Tailwind CSS ë¡œë“œë¨');
                    resolve();
                };
                script.onerror = (error) => {
                    console.error('âŒ Tailwind CSS ë¡œë“œ ì‹¤íŒ¨:', error);
                    // Tailwind ë¡œë“œ ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì ìš©
                    applyFallbackStyles();
                    reject(error);
                };
                document.head.appendChild(script);
            });
        }
        
        // Tailwind ë¡œë“œ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ìŠ¤íƒ€ì¼
        function applyFallbackStyles() {
            const style = document.createElement('style');
            style.textContent = `
                body { font-family: system-ui, -apple-system, sans-serif; }
                .bg-gradient-to-br { background: linear-gradient(135deg, #f3f4f6, #dbeafe, #d1fae5); }
                .min-h-screen { min-height: 100vh; }
                .flex { display: flex; }
                .items-center { align-items: center; }
                .justify-center { justify-content: center; }
                .bg-white { background-color: white; }
                .rounded-xl { border-radius: 0.75rem; }
                .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
                .p-8 { padding: 2rem; }
                .w-full { width: 100%; }
                .max-w-md { max-width: 28rem; }
                .text-center { text-align: center; }
                .mb-8 { margin-bottom: 2rem; }
                .text-3xl { font-size: 1.875rem; }
                .font-bold { font-weight: 700; }
                .text-pink-600 { color: #db2777; }
                .text-gray-600 { color: #4b5563; }
                .space-y-6 > * + * { margin-top: 1.5rem; }
                .block { display: block; }
                .text-sm { font-size: 0.875rem; }
                .font-medium { font-weight: 500; }
                .text-gray-700 { color: #374151; }
                .mb-2 { margin-bottom: 0.5rem; }
                .px-4 { padding-left: 1rem; padding-right: 1rem; }
                .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
                .border { border-width: 1px; }
                .border-gray-300 { border-color: #d1d5db; }
                .rounded-lg { border-radius: 0.5rem; }
                .focus\\:ring-2:focus { box-shadow: 0 0 0 2px rgba(236, 72, 153, 0.5); }
                .focus\\:ring-pink-400:focus { box-shadow: 0 0 0 2px rgba(244, 114, 182, 0.5); }
                .focus\\:outline-none:focus { outline: none; }
                .bg-gradient-to-r { background: linear-gradient(to right, #ec4899, #8b5cf6); }
                .text-white { color: white; }
                .hover\\:from-pink-600:hover { background: linear-gradient(to right, #db2777, #7c3aed); }
                .hover\\:to-purple-600:hover { background: linear-gradient(to right, #ec4899, #7c3aed); }
                .transition { transition: all 0.15s ease-in-out; }
                .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
                .mt-6 { margin-top: 1.5rem; }
                .text-pink-600 { color: #db2777; }
                .hover\\:text-pink-700:hover { color: #be185d; }
                .text-blue-600 { color: #2563eb; }
                .hover\\:text-blue-700:hover { color: #1d4ed8; }
                .text-xs { font-size: 0.75rem; }
                .text-gray-500 { color: #6b7280; }
                .mt-2 { margin-top: 0.5rem; }
            `;
            document.head.appendChild(style);
            console.log('âš ï¸ Tailwind CSS ëŒ€ì²´ ìŠ¤íƒ€ì¼ ì ìš©ë¨');
        }
        
        // Tailwind CSS ë¡œë”© ì‹œì‘
        loadTailwindCSS().catch(() => {
            console.log('âš ï¸ Tailwind CSS ë¡œë”© ì‹¤íŒ¨, ëŒ€ì²´ ìŠ¤íƒ€ì¼ ì‚¬ìš©');
        });
    </script>
    
    
    <script>
        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘...');
            
            // Firebase ì¤€ë¹„ ëŒ€ê¸° í›„ ì‹¤ì‹œê°„ êµ¬ë… ì‹œì‘
            setTimeout(async () => {
                try {
                    await waitForFirebase();
                    subscribeToUsers();
                    console.log('âœ… ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ Firebase ì—°ë™ ì™„ë£Œ');
                } catch (error) {
                    console.error('âŒ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                    // ì´ˆê¸°í™” ì‹¤íŒ¨ì‹œ 3ì´ˆ í›„ ì¬ì‹œë„
                    setTimeout(() => {
                        console.log('ğŸ”„ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì¬ì‹œë„...');
                        location.reload();
                    }, 3000);
                }
            }, 1000);
        });
        
        // Firebase SDK ë¡œë”© ëŒ€ê¸° í•¨ìˆ˜ (ë‹¨ìˆœí™”ëœ ë²„ì „)
        function waitForFirebaseAndInitialize() {
            const maxAttempts = 8; // 8ì´ˆ ëŒ€ê¸°
            let attempts = 0;
            
            const checkFirebase = () => {
                attempts++;
                console.log(`ğŸ” Firebase SDK í™•ì¸ ì‹œë„ ${attempts}/${maxAttempts}`);
                
                // Firebase SDK ì™„ì „ ë¡œë“œ í™•ì¸
                if (typeof firebase !== 'undefined' && 
                    firebase.apps !== undefined && 
                    firebase.auth !== undefined && 
                    firebase.firestore !== undefined) {
                    
                    console.log('âœ… Firebase SDK ì™„ì „ ë¡œë“œë¨');
                    console.log('Firebase ë²„ì „:', firebase.SDK_VERSION);
                    
                    // Firebase ì´ˆê¸°í™” ì‹œë„
                    try {
                        const initResult = initializeFirebase();
                        if (initResult) {
                            console.log('âœ… Firebase ì´ˆê¸°í™” ì™„ë£Œ');
                            setupAdminDashboard();
                        } else {
                            console.error('âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨');
                            showFirebaseError('Firebase ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. Netlify CSP í—¤ë”ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                        }
                    } catch (error) {
                        console.error('âŒ Firebase ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜:', error);
                        showFirebaseError('Firebase ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    }
                } else if (attempts < maxAttempts) {
                    console.log('â³ Firebase SDK ë¡œë”© ëŒ€ê¸° ì¤‘...');
                    setTimeout(checkFirebase, 1000);
                } else {
                    console.error('âŒ Firebase SDK ë¡œë”© ì‹œê°„ ì´ˆê³¼');
                    showFirebaseError('Firebase SDK ë¡œë”© ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nNetlify CSP ì •ì±…ì—ì„œ ë‹¤ìŒ ë„ë©”ì¸ë“¤ì´ í—ˆìš©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤:\n- https://www.gstatic.com\n- https://www.gstatic.com/firebasejs\n\nnetlify.toml íŒŒì¼ì˜ CSP ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.');
                }
            };
            
            checkFirebase();
        }
        
        // Firebase ì˜¤ë¥˜ í‘œì‹œ í•¨ìˆ˜ (CSP ìµœì í™” ë²„ì „)
        function showFirebaseError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'fixed top-4 right-4 bg-red-500 text-white p-4 rounded-lg shadow-lg z-50 max-w-md';
            errorDiv.innerHTML = `
                <div class="font-bold mb-2">ğŸ”¥ Firebase ì˜¤ë¥˜</div>
                <div class="text-sm mb-2">${message}</div>
                <div class="text-xs mb-3 p-2 bg-red-600 rounded">
                    <strong>CSP í•´ê²° ë°©ë²•:</strong><br>
                    1. DevTools â†’ Network â†’ Response Headers í™•ì¸<br>
                    2. content-security-policyì— www.gstatic.com í¬í•¨ í™•ì¸<br>
                    3. ì„œë²„ ì¬ì‹œì‘ í›„ ìƒˆë¡œê³ ì¹¨<br>
                    4. ë¸Œë¼ìš°ì € ìºì‹œ ì™„ì „ ì‚­ì œ<br>
                    5. ì„œë¹„ìŠ¤ì›Œì»¤ ë“±ë¡ í•´ì œ
                </div>
                <div class="flex gap-2 flex-wrap">
                    <button onclick="location.reload()" class="px-3 py-1 bg-white text-red-500 rounded text-xs font-bold hover:bg-gray-100">
                        ğŸ”„ ìƒˆë¡œê³ ì¹¨
                    </button>
                    <button onclick="testFirebaseConnection()" class="px-3 py-1 bg-yellow-500 text-white rounded text-xs font-bold hover:bg-yellow-600">
                        ğŸ§ª ì—°ê²° í…ŒìŠ¤íŠ¸
                    </button>
                    <button onclick="clearCacheAndReload()" class="px-3 py-1 bg-orange-500 text-white rounded text-xs font-bold hover:bg-orange-600">
                        ğŸ§¹ ìºì‹œ ì •ë¦¬
                    </button>
                    <button onclick="this.parentElement.parentElement.remove()" class="px-3 py-1 bg-gray-500 text-white rounded text-xs font-bold hover:bg-gray-600">
                        âœ• ë‹«ê¸°
                    </button>
                </div>
            `;
            document.body.appendChild(errorDiv);
            
            // 20ì´ˆ í›„ ìë™ ì œê±° (CSP ë¬¸ì œëŠ” í•´ê²° ì‹œê°„ì´ ë” í•„ìš”)
            setTimeout(() => {
                if (errorDiv.parentElement) {
                    errorDiv.remove();
                }
            }, 20000);
        }
        
        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì„¤ì •
        function setupAdminDashboard() {
            console.log('ğŸ”§ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì„¤ì • ì‹œì‘...');
            
            // Firebase ìƒíƒœ ì¬í™•ì¸
            if (!window.firebaseAuth || !window.firebaseDb) {
                console.error('âŒ Firebase ì„œë¹„ìŠ¤ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                showFirebaseError('Firebase ì„œë¹„ìŠ¤ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('âœ… ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì„¤ì • ì™„ë£Œ');
        }
        
        // ê´€ë¦¬ì ë¡œê·¸ì¸ í•¨ìˆ˜
        window.adminLogin = async function() {
            console.log('ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œë„...');
            
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            
            if (!email || !password) {
                alert('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // Firebase ê°€ë“œ í™•ì¸
            if (!window.firebaseApp) {
                alert('Firebase SDKê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì„œë²„ CSP í—¤ë”ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!window.firebaseAuth) {
                console.error('âŒ Firebase Authê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                alert('Firebase Auth ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                console.log('ğŸ”¥ ë¡œê·¸ì¸ ì‹œë„:', email);
                // Firebase v9ì—ì„œëŠ” signInWithEmailAndPasswordë¥¼ ì§ì ‘ importí•´ì•¼ í•¨
                const { signInWithEmailAndPassword } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js');
                const userCredential = await signInWithEmailAndPassword(window.firebaseAuth, email, password);
                console.log('âœ… ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ:', userCredential.user.email);
                
                // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                document.getElementById('login-section').classList.add('hidden');
                document.getElementById('dashboard-section').classList.remove('hidden');
                
                // ê´€ë¦¬ì ì •ë³´ í‘œì‹œ
                if (document.getElementById('admin-info')) {
                    document.getElementById('admin-info').textContent = userCredential.user.email;
                }
                
                // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
                loadDashboardData();
                
            } catch (error) {
                console.error('âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);
                let errorMessage = 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                
                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'ë“±ë¡ë˜ì§€ ì•Šì€ ì´ë©”ì¼ì…ë‹ˆë‹¤.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'ë„ˆë¬´ ë§ì€ ë¡œê·¸ì¸ ì‹œë„ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                        break;
                    default:
                        errorMessage = error.message;
                }
                
                alert(errorMessage);
            }
        };
        
        // í…ŒìŠ¤íŠ¸ ê´€ë¦¬ì ê³„ì • ìƒì„± í•¨ìˆ˜
        window.createAdminAccount = async function() {
            try {
                console.log('ğŸ”§ í…ŒìŠ¤íŠ¸ ê´€ë¦¬ì ê³„ì • ìƒì„± ì‹œì‘...');
                
                if (!firebase.auth) { 
                    alert("Firebase Auth ì´ˆê¸°í™” ì‹¤íŒ¨"); 
                    throw new Error("Auth not initialized"); 
                }
                
                if (!window.firebaseAuth) {
                    alert('Firebaseê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // Firebase v9ì—ì„œëŠ” createUserWithEmailAndPasswordë¥¼ ì§ì ‘ importí•´ì•¼ í•¨
                const { createUserWithEmailAndPassword } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js');
                const userCredential = await createUserWithEmailAndPassword(window.firebaseAuth, 'admin@pricehunter.com', 'admin1234');
                console.log('âœ… í…ŒìŠ¤íŠ¸ ê´€ë¦¬ì ê³„ì • ìƒì„± ì™„ë£Œ:', userCredential.user.email);
                
                // Firestoreì— ê´€ë¦¬ì ì •ë³´ ì €ì¥
                if (window.firebaseDb) {
                    const { collection, doc, setDoc, serverTimestamp } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                    await setDoc(doc(collection(window.firebaseDb, 'admins'), userCredential.user.uid), {
                        email: 'admin@pricehunter.com',
                        role: 'admin',
                        createdAt: serverTimestamp(),
                        permissions: ['read', 'write', 'delete', 'admin']
                    });
                    console.log('âœ… ê´€ë¦¬ì ì •ë³´ Firestore ì €ì¥ ì™„ë£Œ');
                }
                
                alert('âœ… í…ŒìŠ¤íŠ¸ ê´€ë¦¬ì ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì´ë©”ì¼: admin@pricehunter.com\në¹„ë°€ë²ˆí˜¸: admin1234\n\nì´ì œ ì´ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                
                // ì…ë ¥ í•„ë“œì— ìë™ ì…ë ¥
                document.getElementById('admin-email').value = 'admin@pricehunter.com';
                document.getElementById('admin-password').value = 'admin1234';
                
            } catch (error) {
                console.error('âŒ í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± ì‹¤íŒ¨:', error);
                
                if (error.code === 'auth/email-already-in-use') {
                    alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê³„ì •ì…ë‹ˆë‹¤!\n\nì´ë©”ì¼: admin@pricehunter.com\në¹„ë°€ë²ˆí˜¸: admin1234\n\nì´ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ë³´ì„¸ìš”.');
                    
                    // ì…ë ¥ í•„ë“œì— ìë™ ì…ë ¥
                    document.getElementById('admin-email').value = 'admin@pricehunter.com';
                    document.getElementById('admin-password').value = 'admin1234';
                } else {
                    alert('ê³„ì • ìƒì„± ì‹¤íŒ¨: ' + error.message);
                }
            }
        };
        
        // Firebase v9 ê¸°ë°˜ í•¨ìˆ˜ë“¤ (ê°œì„ ëœ ë²„ì „)
        let isFirebaseReady = false;
        let usersUnsubscribe = null;

        // Firebase ì¤€ë¹„ ìƒíƒœ í™•ì¸ (Firebase v8)
        async function waitForFirebase() {
            try {
                console.log('ğŸ”„ Firebase ì¤€ë¹„ ìƒíƒœ í™•ì¸ ì¤‘...');
                
                // Firebase v9 ì´ˆê¸°í™” í™•ì¸
                if (window.firebaseApp && window.firebaseAuth && window.firebaseDb) {
                    isFirebaseReady = true;
                    console.log('âœ… Firebase v9 ì´ˆê¸°í™” ì„±ê³µ');
                    return;
                }
                
                // ì¬ì‹œë„
                setTimeout(() => waitForFirebase(), 100);
            } catch (error) {
                console.error('âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                setTimeout(() => waitForFirebase(), 1000);
            }
        }

        // ì‹¤ì‹œê°„ ì‚¬ìš©ì ëª©ë¡ êµ¬ë… (Firebase v9 + localStorage ë°±ì—…) - ê°œì„ ëœ ë²„ì „
        function subscribeToUsers() {
            console.log('ğŸ‘¥ ì‚¬ìš©ì ëª©ë¡ êµ¬ë… ì‹œì‘...');
            
            // localStorageì—ì„œ ì‚¬ìš©ì ë°ì´í„°ë„ ê°€ì ¸ì˜¤ê¸°
            loadLocalStorageUsers();
            
            if (!window.firebaseDb) {
                console.warn('âš ï¸ Firebaseê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. localStorage ë°ì´í„°ë§Œ í‘œì‹œí•©ë‹ˆë‹¤.');
                return;
            }
            
            try {
                const { collection, query, orderBy, onSnapshot } = window.firebaseFirestoreFunctions;
                const usersRef = collection(window.firebaseDb, 'users');
                
                // createdAt í•„ë“œê°€ ì—†ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê¸°ë³¸ ì¿¼ë¦¬ ì‚¬ìš©
                let usersQuery;
                try {
                    usersQuery = query(usersRef, orderBy('createdAt', 'desc'));
                } catch (error) {
                    console.warn('âš ï¸ createdAt í•„ë“œë¡œ ì •ë ¬ ì‹¤íŒ¨, ê¸°ë³¸ ì¿¼ë¦¬ ì‚¬ìš©:', error);
                    usersQuery = query(usersRef);
                }

                usersUnsubscribe = onSnapshot(usersQuery, (snapshot) => {
                    const firebaseUsers = [];
                    snapshot.forEach((doc) => {
                        const userData = doc.data();
                        firebaseUsers.push({ 
                            id: doc.id, 
                            ...userData,
                            source: 'Firebase'
                        });
                    });
                    
                    console.log('ğŸ“Š Firebase ì‚¬ìš©ì ë°ì´í„° ì—…ë°ì´íŠ¸:', firebaseUsers.length, 'ëª…');
                    console.log('ğŸ“‹ Firebase ì‚¬ìš©ì ë°ì´í„°:', firebaseUsers);
                    
                    // localStorage ì‚¬ìš©ìì™€ Firebase ì‚¬ìš©ì í•©ì¹˜ê¸°
                    const allUsers = mergeUsersData(firebaseUsers);
                    updateUsersTable(allUsers);
                    
                    // íšŒì›ìˆ˜ ì—…ë°ì´íŠ¸
                    const totalMembersElement = document.getElementById('total-members');
                    if (totalMembersElement) {
                        totalMembersElement.textContent = allUsers.length;
                    }
                    
                    // í†µê³„ ì—…ë°ì´íŠ¸
                    updateMemberStats(allUsers);
                    
                }, (error) => {
                    console.error('âŒ ì‚¬ìš©ì ëª©ë¡ ì‹¤ì‹œê°„ êµ¬ë… ì‹¤íŒ¨:', error);
                    // Firebase ì—°ê²° ì‹¤íŒ¨ì‹œ localStorage ë°ì´í„°ë§Œ í‘œì‹œ
                    console.log('ğŸ”„ localStorage ë°ì´í„°ë§Œ í‘œì‹œí•©ë‹ˆë‹¤.');
                    loadLocalStorageUsers();
                    
                    // ì—°ê²° ì‹¤íŒ¨ì‹œ 5ì´ˆ í›„ ì¬ì‹œë„
                    setTimeout(() => {
                        console.log('ğŸ”„ Firestore ì—°ê²° ì¬ì‹œë„...');
                        subscribeToUsers();
                    }, 5000);
                });
            } catch (error) {
                console.error('âŒ Firestore ì¿¼ë¦¬ ìƒì„± ì‹¤íŒ¨:', error);
                // ì¿¼ë¦¬ ìƒì„± ì‹¤íŒ¨ì‹œ localStorage ë°ì´í„°ë§Œ í‘œì‹œ
                loadLocalStorageUsers();
                
                // ì¿¼ë¦¬ ìƒì„± ì‹¤íŒ¨ì‹œ 3ì´ˆ í›„ ì¬ì‹œë„
                setTimeout(() => {
                    console.log('ğŸ”„ Firestore ì¿¼ë¦¬ ì¬ì‹œë„...');
                    subscribeToUsers();
                }, 3000);
            }
        }

        // localStorageì—ì„œ ì‚¬ìš©ì ë°ì´í„° ë¡œë“œ
        function loadLocalStorageUsers() {
            try {
                const users = [];
                
                // ì¼ë°˜ ì‚¬ìš©ì ë°ì´í„°
                const userData = localStorage.getItem('user');
                if (userData) {
                    const user = JSON.parse(userData);
                    users.push({
                        id: user.firebaseId || 'local_' + Date.now(),
                        ...user,
                        source: 'localStorage'
                    });
                }
                
                // ì¹´ì¹´ì˜¤ ì‚¬ìš©ì ë°ì´í„°ë“¤
                const keys = Object.keys(localStorage);
                keys.forEach(key => {
                    if (key.startsWith('kakao_') && !key.includes('auth_')) {
                        try {
                            const storedData = localStorage.getItem(key);
                            if (storedData && storedData.startsWith('{')) {
                                const kakaoUser = JSON.parse(storedData);
                                users.push({
                                    id: kakaoUser.firebaseId || key,
                                    ...kakaoUser,
                                    source: 'localStorage'
                                });
                            }
                        } catch (e) {
                            console.warn('ì¹´ì¹´ì˜¤ ì‚¬ìš©ì ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);
                        }
                    }
                });
                
                console.log('ğŸ“Š localStorage ì‚¬ìš©ì ë°ì´í„°:', users.length);
                updateUsersTable(users);
                document.getElementById('total-members').textContent = users.length;
                
            } catch (error) {
                console.error('âŒ localStorage ì‚¬ìš©ì ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // Firebaseì™€ localStorage ì‚¬ìš©ì ë°ì´í„° í•©ì¹˜ê¸°
        function mergeUsersData(firebaseUsers) {
            console.log('ğŸ”„ ì‚¬ìš©ì ë°ì´í„° ë³‘í•© ì‹œì‘...');
            console.log('ğŸ“Š Firebase ì‚¬ìš©ì:', firebaseUsers.length, 'ëª…');
            
            // Firebase ì‚¬ìš©ìì—ì„œë„ ì¤‘ë³µ ì œê±° (ì´ë©”ì¼ ê¸°ì¤€)
            const firebaseUserMap = new Map();
            firebaseUsers.forEach(user => {
                if (user.email) {
                    // ê°™ì€ ì´ë©”ì¼ì´ ìˆìœ¼ë©´ ë” ìµœì‹  ë°ì´í„°ë¥¼ ìœ ì§€
                    if (!firebaseUserMap.has(user.email) || 
                        (user.createdAt && firebaseUserMap.get(user.email).createdAt && 
                         user.createdAt > firebaseUserMap.get(user.email).createdAt)) {
                        firebaseUserMap.set(user.email, user);
                    }
                }
            });
            
            const uniqueFirebaseUsers = Array.from(firebaseUserMap.values());
            console.log('ğŸ“Š ì¤‘ë³µ ì œê±° í›„ Firebase ì‚¬ìš©ì:', uniqueFirebaseUsers.length, 'ëª…');
            
            // Firebase ì‚¬ìš©ìë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš© (ìš°ì„ ìˆœìœ„)
            const allUsers = [...uniqueFirebaseUsers];
            const emailSet = new Set(uniqueFirebaseUsers.map(user => user.email));
            
            // localStorageì—ì„œ users ë°°ì—´ í™•ì¸
            try {
                const usersArray = JSON.parse(localStorage.getItem('users') || '[]');
                console.log('ğŸ“‹ localStorage users ë°°ì—´:', usersArray.length, 'ëª…');
                
                usersArray.forEach(user => {
                    if (user.email && !emailSet.has(user.email)) {
                        allUsers.push({
                            id: user.firebaseId || 'local_' + Date.now(),
                            ...user,
                            source: 'localStorage'
                        });
                        emailSet.add(user.email);
                    }
                });
            } catch (error) {
                console.warn('âš ï¸ localStorage users ë°°ì—´ íŒŒì‹± ì‹¤íŒ¨:', error);
            }
            
            // ê°œë³„ user ë°ì´í„° í™•ì¸
            const userData = localStorage.getItem('user');
            if (userData) {
                try {
                    const user = JSON.parse(userData);
                    if (user.email && !emailSet.has(user.email)) {
                        allUsers.push({
                            id: user.firebaseId || 'local_' + Date.now(),
                            ...user,
                            source: 'localStorage'
                        });
                        emailSet.add(user.email);
                    }
                } catch (error) {
                    console.warn('âš ï¸ localStorage user ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', error);
                }
            }
            
            // ì¹´ì¹´ì˜¤ ì‚¬ìš©ìë“¤ë„ í™•ì¸
            const keys = Object.keys(localStorage);
            keys.forEach(key => {
                if (key.startsWith('kakao_') && !key.includes('auth_')) {
                    try {
                        const storedData = localStorage.getItem(key);
                        if (storedData && storedData.startsWith('{')) {
                            const kakaoUser = JSON.parse(storedData);
                            if (kakaoUser.email && !emailSet.has(kakaoUser.email)) {
                                allUsers.push({
                                    id: kakaoUser.firebaseId || key,
                                    ...kakaoUser,
                                    source: 'localStorage'
                                });
                                emailSet.add(kakaoUser.email);
                            }
                        }
                    } catch (e) {
                        console.warn('âš ï¸ ì¹´ì¹´ì˜¤ ì‚¬ìš©ì ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', key, e);
                    }
                }
            });
            
            // ìµœì¢… ì¤‘ë³µ ê²€ì‚¬
            const finalEmailSet = new Set();
            const finalUsers = [];
            allUsers.forEach(user => {
                if (user.email && !finalEmailSet.has(user.email)) {
                    finalUsers.push(user);
                    finalEmailSet.add(user.email);
                }
            });
            
            console.log('âœ… ì‚¬ìš©ì ë°ì´í„° ë³‘í•© ì™„ë£Œ:', finalUsers.length, 'ëª…');
            console.log('ğŸ“‹ ìµœì¢… ì‚¬ìš©ì ëª©ë¡:', finalUsers.map(u => ({ email: u.email, source: u.source, name: u.name || u.displayName })));
            
            return finalUsers;
        }

        // íšŒì› í†µê³„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateMemberStats(users) {
            try {
                const kakaoUsers = users.filter(user => (user.loginMethod || user.loginType) === 'kakao').length;
                const emailUsers = users.filter(user => (user.loginMethod || user.loginType) === 'email').length;
                const firebaseUsers = users.filter(user => user.source === 'Firebase').length;
                const localStorageUsers = users.filter(user => user.source === 'localStorage').length;
                
                console.log('ğŸ“Š íšŒì› í†µê³„:', {
                    total: users.length,
                    kakao: kakaoUsers,
                    email: emailUsers,
                    firebase: firebaseUsers,
                    localStorage: localStorageUsers
                });
                
                // í†µê³„ë¥¼ í™”ë©´ì— í‘œì‹œ (í•„ìš”ì‹œ)
                const statsElement = document.getElementById('member-stats');
                if (statsElement) {
                    statsElement.innerHTML = `
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-lg text-blue-600">${kakaoUsers}</div>
                                <div class="text-gray-600">ì¹´ì¹´ì˜¤í†¡</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-green-600">${emailUsers}</div>
                                <div class="text-gray-600">ì´ë©”ì¼</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-purple-600">${firebaseUsers}</div>
                                <div class="text-gray-600">Firebase</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-orange-600">${localStorageUsers}</div>
                                <div class="text-gray-600">localStorage</div>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('âŒ íšŒì› í†µê³„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }

        // ì‚¬ìš©ì í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ê°œì„ ëœ ë²„ì „)
        function updateUsersTable(users) {
            console.log('ğŸ“‹ íšŒì› í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘...');
            console.log('ğŸ‘¥ í‘œì‹œí•  ì‚¬ìš©ì ìˆ˜:', users.length);
            
            const tbody = document.getElementById('members-table-body');
            if (!tbody) {
                console.error('âŒ members-table-body ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            tbody.innerHTML = '';

            if (users.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" class="px-6 py-4 text-center text-gray-500">
                            ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            // ì‚¬ìš©ì ë°ì´í„° ì •ë ¬ (Firebase ìš°ì„ , ìµœì‹ ìˆœ)
            const sortedUsers = users.sort((a, b) => {
                // Firebase ì‚¬ìš©ìë¥¼ ìš°ì„ ìœ¼ë¡œ
                if (a.source === 'Firebase' && b.source !== 'Firebase') return -1;
                if (a.source !== 'Firebase' && b.source === 'Firebase') return 1;
                
                // ê°™ì€ ì†ŒìŠ¤ ë‚´ì—ì„œëŠ” ìµœì‹ ìˆœ
                const dateA = a.createdAt ? (a.createdAt.seconds ? a.createdAt.seconds * 1000 : new Date(a.createdAt).getTime()) : 0;
                const dateB = b.createdAt ? (b.createdAt.seconds ? b.createdAt.seconds * 1000 : new Date(b.createdAt).getTime()) : 0;
                return dateB - dateA;
            });

            sortedUsers.forEach((user, index) => {
                console.log(`ğŸ‘¤ ì‚¬ìš©ì ${index + 1}:`, {
                    email: user.email,
                    name: user.displayName || user.name,
                    source: user.source,
                    phone: user.phone
                });
                
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const profileImage = user.photoURL || user.profileImage || 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%236b7280"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>';
                const loginMethod = user.loginMethod || user.loginType || 'email';
                
                // ë‚ ì§œ ì²˜ë¦¬ ê°œì„ 
                let joinDate = 'ì•Œ ìˆ˜ ì—†ìŒ';
                if (user.createdAt) {
                    if (user.createdAt.seconds) {
                        joinDate = new Date(user.createdAt.seconds * 1000).toLocaleDateString('ko-KR');
                    } else if (user.createdAt.toDate) {
                        joinDate = user.createdAt.toDate().toLocaleDateString('ko-KR');
                    } else {
                        joinDate = new Date(user.createdAt).toLocaleDateString('ko-KR');
                    }
                } else if (user.joinDate) {
                    joinDate = new Date(user.joinDate).toLocaleDateString('ko-KR');
                }
                
                let lastUpdate = 'ì•Œ ìˆ˜ ì—†ìŒ';
                if (user.updatedAt) {
                    if (user.updatedAt.seconds) {
                        lastUpdate = new Date(user.updatedAt.seconds * 1000).toLocaleDateString('ko-KR');
                    } else if (user.updatedAt.toDate) {
                        lastUpdate = user.updatedAt.toDate().toLocaleDateString('ko-KR');
                    } else {
                        lastUpdate = new Date(user.updatedAt).toLocaleDateString('ko-KR');
                    }
                }
                
                const dataSource = user.source || 'Firebase';
                const dataSourceColor = dataSource === 'localStorage' ? 'bg-orange-100 text-orange-800' : 'bg-green-100 text-green-800';
                const points = user.points || 0;
                const userName = user.displayName || user.name || 'ì´ë¦„ ì—†ìŒ';
                const userEmail = user.email || 'ì´ë©”ì¼ ì—†ìŒ';
                const userPhone = user.phone || '-';
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="h-10 w-10 flex-shrink-0">
                                <div class="h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 text-xs font-bold">
                                    ${userName.charAt(0)}
                                </div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${userName}</div>
                        <div class="text-xs text-gray-500">${points}P</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${loginMethod === 'kakao' ? 'bg-yellow-100 text-yellow-800' : 'bg-blue-100 text-blue-800'}">
                            ${loginMethod === 'kakao' ? 'ì¹´ì¹´ì˜¤í†¡' : 'ì´ë©”ì¼'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${userEmail}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${userPhone}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${joinDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${lastUpdate}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${dataSourceColor}">
                            ${dataSource}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="viewUserDetails('${user.email || user.id}')" class="text-indigo-600 hover:text-indigo-900 mr-3">ìƒì„¸ë³´ê¸°</button>
                        <button onclick="deleteUser('${user.email || user.id}')" class="text-red-600 hover:text-red-900">ì‚­ì œ</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            console.log('âœ… íšŒì› í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        }

        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
        function loadDashboardData() {
            console.log('ğŸ“Š ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
            
            if (!window.firebaseDb) {
                console.error('âŒ Firestoreê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì—¬ê¸°ì— ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ë¡œì§ ì¶”ê°€
            console.log('âœ… ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
        }
        
        // Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testFirebaseConnection = async function() {
            try {
                console.log('ğŸ”¥ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
                
                if (!window.firebaseApp || !window.firebaseDb || !window.firebaseAuth) {
                    alert('âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨!\n\nFirebase ì„œë¹„ìŠ¤ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                    return false;
                }
                
                const { collection, addDoc, serverTimestamp, getDoc, deleteDoc } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                const testRef = collection(window.firebaseDb, 'test');
                
                // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì“°ê¸°
                console.log('ğŸ“ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì“°ê¸° ì¤‘...');
                const testDoc = await addDoc(testRef, {
                    test: true,
                    timestamp: serverTimestamp(),
                    message: 'ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸',
                    testTime: new Date().toISOString()
                });
                
                console.log('âœ… Firebase ì“°ê¸° í…ŒìŠ¤íŠ¸ ì„±ê³µ:', testDoc.id);
                
                // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì½ê¸°
                console.log('ğŸ“– í…ŒìŠ¤íŠ¸ ë°ì´í„° ì½ê¸° ì¤‘...');
                const testData = await getDoc(testDoc);
                console.log('âœ… Firebase ì½ê¸° í…ŒìŠ¤íŠ¸ ì„±ê³µ:', testData.data());
                
                // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ
                console.log('ğŸ—‘ï¸ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ ì¤‘...');
                await deleteDoc(testDoc);
                console.log('âœ… Firebase ì‚­ì œ í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                
                alert('âœ… Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ ì„±ê³µ!\n\nëª¨ë“  ì‘ì—…(ì½ê¸°/ì“°ê¸°/ì‚­ì œ)ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.\n\në¬¸ì„œ ID: ' + testDoc.id);
                return true;
                
            } catch (error) {
                console.error('âŒ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
                console.error('ì˜¤ë¥˜ ìƒì„¸:', {
                    message: error.message,
                    code: error.code,
                    stack: error.stack
                });
                
                if (error.message.includes('Missing or insufficient permissions') || error.code === 'permission-denied') {
                    alert('âŒ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨!\n\n' +
                          'Firebase ë³´ì•ˆ ê·œì¹™ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' +
                          'í•´ê²° ë°©ë²•:\n' +
                          '1. Firebase ì½˜ì†” ì ‘ì†: https://console.firebase.google.com/\n' +
                          '2. pricehunter-99a1b í”„ë¡œì íŠ¸ ì„ íƒ\n' +
                          '3. Firestore Database â†’ ê·œì¹™\n' +
                          '4. FIREBASE_SECURITY_RULES.md íŒŒì¼ ì°¸ê³ í•˜ì—¬ ê·œì¹™ ìˆ˜ì •\n' +
                          '5. ê²Œì‹œ ë²„íŠ¼ í´ë¦­');
                } else {
                    alert('âŒ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨!\n\nì˜¤ë¥˜: ' + error.message + '\n\nì½”ë“œ: ' + (error.code || 'N/A'));
                }
                
                return false;
            }
        };

        // Firebase ì‚¬ìš©ì ë°ì´í„° ì§ì ‘ í™•ì¸ í•¨ìˆ˜
        window.checkFirebaseUsers = async function() {
            try {
                console.log('ğŸ” Firebase ì‚¬ìš©ì ë°ì´í„° ì§ì ‘ í™•ì¸ ì‹œì‘...');
                
                if (!window.firebaseDb) {
                    alert('âŒ Firebaseê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                const { collection, getDocs } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                const usersRef = collection(window.firebaseDb, 'users');
                const snapshot = await getDocs(usersRef);
                
                console.log('ğŸ“Š Firebase users ì»¬ë ‰ì…˜ ì´ ë¬¸ì„œ ìˆ˜:', snapshot.size);
                
                const users = [];
                snapshot.forEach(doc => {
                    const userData = doc.data();
                    users.push({
                        id: doc.id,
                        ...userData
                    });
                    console.log('ğŸ‘¤ Firebase ì‚¬ìš©ì ìƒì„¸ ì •ë³´:', {
                        id: doc.id,
                        email: userData.email,
                        displayName: userData.displayName,
                        name: userData.name,
                        phone: userData.phone,
                        password: userData.password ? '***' : 'ì—†ìŒ',
                        agreeTerms: userData.agreeTerms,
                        agreePrivacy: userData.agreePrivacy,
                        agreeMarketing: userData.agreeMarketing,
                        createdAt: userData.createdAt,
                        loginMethod: userData.loginMethod,
                        isActive: userData.isActive,
                        loginCount: userData.loginCount
                    });
                });
                
                // í•„ìˆ˜ í•„ë“œ ëˆ„ë½ í™•ì¸
                const missingFields = [];
                users.forEach(user => {
                    const missing = [];
                    if (!user.password) missing.push('password');
                    if (!user.phone) missing.push('phone');
                    if (!user.name && !user.displayName) missing.push('name');
                    if (missing.length > 0) {
                        missingFields.push({
                            email: user.email,
                            missing: missing
                        });
                    }
                });
                
                if (missingFields.length > 0) {
                    console.warn('âš ï¸ í•„ìˆ˜ í•„ë“œ ëˆ„ë½:', missingFields);
                    let message = `âš ï¸ Firebase ì‚¬ìš©ì ë°ì´í„°ì— í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n`;
                    missingFields.forEach(item => {
                        message += `${item.email}: ${item.missing.join(', ')}\n`;
                    });
                    message += `\nì´ê²ƒì´ ë¡œê·¸ì¸/ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ê°€ ì‘ë™í•˜ì§€ ì•ŠëŠ” ì´ìœ ì…ë‹ˆë‹¤.\n\në°ì´í„°ë¥¼ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
                    
                    if (confirm(message)) {
                        await fixMissingUserData(users, missingFields);
                    }
                }
                
                // ì´ë©”ì¼ë³„ ì¤‘ë³µ í™•ì¸
                const emailCount = {};
                const emailUsers = {};
                users.forEach(user => {
                    if (user.email) {
                        emailCount[user.email] = (emailCount[user.email] || 0) + 1;
                        if (!emailUsers[user.email]) {
                            emailUsers[user.email] = [];
                        }
                        emailUsers[user.email].push(user);
                    }
                });
                
                const duplicates = Object.entries(emailCount).filter(([email, count]) => count > 1);
                
                if (duplicates.length > 0) {
                    console.warn('âš ï¸ Firebaseì—ì„œ ì¤‘ë³µ ì´ë©”ì¼ ë°œê²¬:', duplicates);
                    
                    let message = `âš ï¸ Firebaseì—ì„œ ì¤‘ë³µ ì´ë©”ì¼ ë°œê²¬!\n\nì¤‘ë³µëœ ì´ë©”ì¼:\n`;
                    duplicates.forEach(([email, count]) => {
                        message += `${email}: ${count}ê°œ\n`;
                    });
                    message += `\nì¤‘ë³µ ë¬¸ì„œë¥¼ ì •ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
                    
                    if (confirm(message)) {
                        await cleanupDuplicateUsers(emailUsers, duplicates);
                    }
                } else {
                    console.log('âœ… Firebaseì—ì„œ ì¤‘ë³µ ì´ë©”ì¼ ì—†ìŒ');
                    alert(`âœ… Firebase ì‚¬ìš©ì ë°ì´í„° í™•ì¸ ì™„ë£Œ!\n\nì´ ì‚¬ìš©ì ìˆ˜: ${users.length}ëª…\nì¤‘ë³µ ì´ë©”ì¼: ì—†ìŒ\nëˆ„ë½ í•„ë“œ: ${missingFields.length > 0 ? 'ìˆìŒ' : 'ì—†ìŒ'}\n\nì½˜ì†”ì—ì„œ ìì„¸í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
                }
                
                return users;
                
            } catch (error) {
                console.error('âŒ Firebase ì‚¬ìš©ì ë°ì´í„° í™•ì¸ ì‹¤íŒ¨:', error);
                alert('âŒ Firebase ì‚¬ìš©ì ë°ì´í„° í™•ì¸ ì‹¤íŒ¨!\n\nì˜¤ë¥˜: ' + error.message);
                return [];
            }
        };

        // ëˆ„ë½ëœ ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì • í•¨ìˆ˜
        window.fixMissingUserData = async function(users, missingFields) {
            try {
                console.log('ğŸ”§ ëˆ„ë½ëœ ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì • ì‹œì‘...');
                
                const { doc, updateDoc } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                
                for (const item of missingFields) {
                    const user = users.find(u => u.email === item.email);
                    if (!user) continue;
                    
                    const updates = {};
                    
                    // localStorageì—ì„œ í•´ë‹¹ ì‚¬ìš©ì ë°ì´í„° ì°¾ê¸°
                    const localUsers = JSON.parse(localStorage.getItem('users') || '[]');
                    const localUser = localUsers.find(u => u.email === item.email);
                    
                    if (localUser) {
                        // localStorageì—ì„œ ëˆ„ë½ëœ í•„ë“œ ë³µì‚¬
                        if (item.missing.includes('password') && localUser.password) {
                            updates.password = localUser.password;
                        }
                        if (item.missing.includes('phone') && localUser.phone) {
                            updates.phone = localUser.phone;
                        }
                        if (item.missing.includes('name') && localUser.name) {
                            updates.name = localUser.name;
                        }
                        if (localUser.agreeTerms !== undefined) updates.agreeTerms = localUser.agreeTerms;
                        if (localUser.agreePrivacy !== undefined) updates.agreePrivacy = localUser.agreePrivacy;
                        if (localUser.agreeMarketing !== undefined) updates.agreeMarketing = localUser.agreeMarketing;
                    }
                    
                    // ê¸°ë³¸ê°’ ì„¤ì •
                    if (item.missing.includes('password') && !updates.password) {
                        updates.password = 'temp123!'; // ì„ì‹œ ë¹„ë°€ë²ˆí˜¸
                    }
                    if (item.missing.includes('phone') && !updates.phone) {
                        updates.phone = '010-0000-0000'; // ê¸°ë³¸ ì „í™”ë²ˆí˜¸
                    }
                    if (item.missing.includes('name') && !updates.name) {
                        updates.name = user.displayName || 'ì‚¬ìš©ì';
                    }
                    if (updates.agreeTerms === undefined) updates.agreeTerms = true;
                    if (updates.agreePrivacy === undefined) updates.agreePrivacy = true;
                    if (updates.agreeMarketing === undefined) updates.agreeMarketing = false;
                    
                    // Firebase ì—…ë°ì´íŠ¸
                    const userDocRef = doc(window.firebaseDb, 'users', user.id);
                    await updateDoc(userDocRef, updates);
                    
                    console.log(`âœ… ${item.email} ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì • ì™„ë£Œ:`, updates);
                }
                
                alert('âœ… ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì • ì™„ë£Œ!\n\nëˆ„ë½ëœ í•„ë“œë“¤ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì´ì œ ë¡œê·¸ì¸ê³¼ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ê°€ ì •ìƒ ì‘ë™í•  ê²ƒì…ë‹ˆë‹¤.');
                
            } catch (error) {
                console.error('âŒ ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì • ì‹¤íŒ¨:', error);
                alert('âŒ ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì • ì‹¤íŒ¨!\n\nì˜¤ë¥˜: ' + error.message);
            }
        };

        // ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬ í•¨ìˆ˜ (ë…ë¦½ í˜¸ì¶œìš©)
        window.cleanupDuplicateUsers = async function(emailUsers, duplicates) {
            // ë§¤ê°œë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ ë¨¼ì € ì¤‘ë³µ í™•ì¸
            if (!emailUsers || !duplicates) {
                const users = await checkFirebaseUsers();
                if (!users || users.length === 0) return;
                
                // ì´ë©”ì¼ë³„ ì¤‘ë³µ í™•ì¸
                const emailCount = {};
                const emailUsersMap = {};
                users.forEach(user => {
                    if (user.email) {
                        emailCount[user.email] = (emailCount[user.email] || 0) + 1;
                        if (!emailUsersMap[user.email]) {
                            emailUsersMap[user.email] = [];
                        }
                        emailUsersMap[user.email].push(user);
                    }
                });
                
                const duplicatesList = Object.entries(emailCount).filter(([email, count]) => count > 1);
                
                if (duplicatesList.length === 0) {
                    alert('âœ… ì¤‘ë³µ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤!');
                    return;
                }
                
                return await cleanupDuplicateUsers(emailUsersMap, duplicatesList);
            }
            try {
                console.log('ğŸ§¹ ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬ ì‹œì‘...');
                
                const { doc, deleteDoc } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                let deletedCount = 0;
                
                for (const [email, count] of duplicates) {
                    const users = emailUsers[email];
                    console.log(`ğŸ“§ ${email}ì˜ ì¤‘ë³µ ë¬¸ì„œë“¤:`, users);
                    
                    // ê°€ì¥ ìµœì‹  ë¬¸ì„œë¥¼ ì œì™¸í•˜ê³  ë‚˜ë¨¸ì§€ ì‚­ì œ
                    const sortedUsers = users.sort((a, b) => {
                        const dateA = a.createdAt ? (a.createdAt.seconds ? a.createdAt.seconds : new Date(a.createdAt).getTime() / 1000) : 0;
                        const dateB = b.createdAt ? (b.createdAt.seconds ? b.createdAt.seconds : new Date(b.createdAt).getTime() / 1000) : 0;
                        return dateB - dateA; // ìµœì‹ ìˆœ ì •ë ¬
                    });
                    
                    // ê°€ì¥ ìµœì‹  ë¬¸ì„œëŠ” ìœ ì§€í•˜ê³  ë‚˜ë¨¸ì§€ ì‚­ì œ
                    for (let i = 1; i < sortedUsers.length; i++) {
                        const userToDelete = sortedUsers[i];
                        console.log(`ğŸ—‘ï¸ ì‚­ì œí•  ë¬¸ì„œ: ${userToDelete.id} (${userToDelete.name || userToDelete.displayName})`);
                        
                        const userDocRef = doc(window.firebaseDb, 'users', userToDelete.id);
                        await deleteDoc(userDocRef);
                        deletedCount++;
                        
                        console.log(`âœ… ë¬¸ì„œ ì‚­ì œ ì™„ë£Œ: ${userToDelete.id}`);
                    }
                }
                
                console.log(`âœ… ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬ ì™„ë£Œ: ${deletedCount}ê°œ ë¬¸ì„œ ì‚­ì œ`);
                alert(`âœ… ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬ ì™„ë£Œ!\n\nì‚­ì œëœ ë¬¸ì„œ ìˆ˜: ${deletedCount}ê°œ\n\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
                
                // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
                
            } catch (error) {
                console.error('âŒ ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬ ì‹¤íŒ¨:', error);
                alert('âŒ ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬ ì‹¤íŒ¨!\n\nì˜¤ë¥˜: ' + error.message);
            }
        };
        
        // CSP í—¤ë” í™•ì¸ í•¨ìˆ˜
        window.checkCSPHeaders = function() {
            console.log('ğŸ” CSP í—¤ë” í™•ì¸ ì‹œì‘...');
            
            // í˜„ì¬ í˜ì´ì§€ì˜ Response Headers í™•ì¸
            fetch(window.location.href, { method: 'HEAD' })
                .then(response => {
                    const cspHeader = response.headers.get('content-security-policy');
                    const serverHeader = response.headers.get('server');
                    const cfRay = response.headers.get('cf-ray');
                    const xVercelId = response.headers.get('x-vercel-id');
                    const xCloudTrace = response.headers.get('x-cloud-trace-context');
                    
                    console.log('ğŸ“‹ Response Headers ë¶„ì„:');
                    console.log('Server:', serverHeader);
                    console.log('CF-Ray:', cfRay);
                    console.log('X-Vercel-ID:', xVercelId);
                    console.log('X-Cloud-Trace:', xCloudTrace);
                    console.log('CSP Header:', cspHeader);
                    
                    // CSP ì£¼ì… ì£¼ì²´ íŒë³„
                    let cspSource = 'Unknown';
                    if (cfRay || response.headers.get('cf-cache-status')) {
                        cspSource = 'Cloudflare';
                    } else if (serverHeader && serverHeader.includes('nginx')) {
                        cspSource = 'Nginx';
                    } else if (serverHeader && serverHeader.includes('apache')) {
                        cspSource = 'Apache';
                    } else if (xVercelId) {
                        cspSource = 'Vercel';
                    } else if (serverHeader && serverHeader.includes('Firebase')) {
                        cspSource = 'Firebase Hosting';
                    }
                    
                    // Firebase ë„ë©”ì¸ í¬í•¨ ì—¬ë¶€ í™•ì¸
                    const hasFirebaseDomains = cspHeader && (
                        cspHeader.includes('www.gstatic.com') || 
                        cspHeader.includes('www.gstatic.com/firebasejs')
                    );
                    
                    const result = `
ğŸ” CSP í—¤ë” ë¶„ì„ ê²°ê³¼:

ğŸ“¡ CSP ì£¼ì… ì£¼ì²´: ${cspSource}
ğŸ”’ CSP í—¤ë” ì¡´ì¬: ${cspHeader ? 'Yes' : 'No'}
ğŸ”¥ Firebase ë„ë©”ì¸ í¬í•¨: ${hasFirebaseDomains ? 'Yes' : 'No'}

${cspHeader ? `ğŸ“‹ í˜„ì¬ CSP ì •ì±…:
${cspHeader.substring(0, 200)}...` : 'âŒ CSP í—¤ë”ê°€ ì—†ìŠµë‹ˆë‹¤.'}

${!hasFirebaseDomains ? 'âš ï¸ Firebase ë„ë©”ì¸ì´ CSPì— í¬í•¨ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!' : 'âœ… Firebase ë„ë©”ì¸ì´ CSPì— í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.'}
                    `;
                    
                    alert(result);
                    console.log('CSP ë¶„ì„ ì™„ë£Œ:', result);
                })
                .catch(error => {
                    console.error('âŒ CSP í—¤ë” í™•ì¸ ì‹¤íŒ¨:', error);
                    alert('âŒ CSP í—¤ë” í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\në¸Œë¼ìš°ì € DevTools â†’ Network â†’ Response Headersë¥¼ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”.');
                });
        };
        
        // ìºì‹œ ë° ì„œë¹„ìŠ¤ì›Œì»¤ ì •ë¦¬ í•¨ìˆ˜ (CSP ì™„ì „ ì •ë¦¬)
        window.clearCacheAndReload = function() {
            console.log('ğŸ§¹ ìºì‹œ ë° ì„œë¹„ìŠ¤ì›Œì»¤ ì™„ì „ ì •ë¦¬ ì‹œì‘...');
            
            let cleanupPromises = [];
            
            // ì„œë¹„ìŠ¤ì›Œì»¤ ë“±ë¡ í•´ì œ
            if ('serviceWorker' in navigator) {
                const swPromise = navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    const unregisterPromises = registrations.map(registration => {
                        console.log('ğŸ—‘ï¸ ì„œë¹„ìŠ¤ì›Œì»¤ ë“±ë¡ í•´ì œ:', registration.scope);
                        return registration.unregister();
                    });
                    return Promise.all(unregisterPromises);
                });
                cleanupPromises.push(swPromise);
            }
            
            // ìºì‹œ ìŠ¤í† ë¦¬ì§€ ì •ë¦¬
            if ('caches' in window) {
                const cachePromise = caches.keys().then(function(cacheNames) {
                    return Promise.all(
                        cacheNames.map(function(cacheName) {
                            console.log('ğŸ—‘ï¸ ìºì‹œ ì‚­ì œ:', cacheName);
                            return caches.delete(cacheName);
                        })
                    );
                });
                cleanupPromises.push(cachePromise);
            }
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì •ë¦¬
            try {
                localStorage.clear();
                sessionStorage.clear();
                console.log('âœ… ë¡œì»¬/ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ê°€ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (e) {
                console.log('âš ï¸ ìŠ¤í† ë¦¬ì§€ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜:', e);
            }
            
            // IndexedDB ì •ë¦¬
            if ('indexedDB' in window) {
                try {
                    indexedDB.databases().then(databases => {
                        databases.forEach(db => {
                            indexedDB.deleteDatabase(db.name);
                            console.log('ğŸ—‘ï¸ IndexedDB ì‚­ì œ:', db.name);
                        });
                    });
                } catch (e) {
                    console.log('âš ï¸ IndexedDB ì •ë¦¬ ì¤‘ ì˜¤ë¥˜:', e);
                }
            }
            
            // ëª¨ë“  ì •ë¦¬ ì‘ì—… ì™„ë£Œ í›„ ìƒˆë¡œê³ ì¹¨
            Promise.all(cleanupPromises).then(() => {
                console.log('âœ… ëª¨ë“  ìºì‹œ ì •ë¦¬ ì™„ë£Œ');
                // ê°•ì œ ìƒˆë¡œê³ ì¹¨ (ìºì‹œ ë¬´ì‹œ + íƒ€ì„ìŠ¤íƒ¬í”„)
                const timestamp = Date.now();
                const url = new URL(window.location);
                url.searchParams.set('v', timestamp);
                url.searchParams.set('cache', 'clear');
                window.location.href = url.toString();
            }).catch(error => {
                console.error('âŒ ìºì‹œ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ê°€ ìˆì–´ë„ ìƒˆë¡œê³ ì¹¨
                const timestamp = Date.now();
                const url = new URL(window.location);
                url.searchParams.set('v', timestamp);
                url.searchParams.set('cache', 'clear');
                window.location.href = url.toString();
            });
        };
        
        // í˜ì´ì§€ ì´ë™ í•¨ìˆ˜
        window.goToPage = function(page) {
            window.location.href = page;
        };
        
        // ì‚¬ì´ë“œë°” ì„¹ì…˜ ì „í™˜ í•¨ìˆ˜ (ì „ì—­ í•¨ìˆ˜)
        window.switchSection = function(sectionName) {
            console.log('ğŸ”„ ì„¹ì…˜ ì „í™˜:', sectionName);
            
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // ëª¨ë“  ì‚¬ì´ë“œë°” ì•„ì´í…œ ë¹„í™œì„±í™”
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
            let targetSection;
            if (sectionName === 'dashboard') {
                // ëŒ€ì‹œë³´ë“œëŠ” dashboard-contentë¥¼ í‘œì‹œ
                targetSection = document.getElementById('dashboard-content');
            } else {
                targetSection = document.getElementById(sectionName + '-section');
            }
            
            if (targetSection) {
                targetSection.classList.remove('hidden');
                console.log('âœ… ì„¹ì…˜ í‘œì‹œ:', sectionName);
            } else {
                console.error('âŒ ì„¹ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ:', sectionName);
            }
            
            // ì„ íƒëœ ì‚¬ì´ë“œë°” ì•„ì´í…œ í™œì„±í™”
            const activeItem = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }
        

        // ì‚¬ìš©ì ìƒì„¸ë³´ê¸° í•¨ìˆ˜
        function viewUserDetails(userId) {
            console.log('ğŸ‘¤ ì‚¬ìš©ì ìƒì„¸ë³´ê¸°:', userId);
            
            // localStorageì—ì„œ ì‚¬ìš©ì ê²€ìƒ‰
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            console.log('ğŸ“‹ localStorage ì‚¬ìš©ì ëª©ë¡:', users);
            
            // ë‹¤ì–‘í•œ ID í•„ë“œë¡œ ì‚¬ìš©ì ì°¾ê¸°
            let user = users.find(u => 
                u.id === userId || 
                u.firebaseId === userId || 
                u.uid === userId ||
                u.email === userId
            );
            
            // Firebaseì—ì„œë„ ê²€ìƒ‰ ì‹œë„
            if (!user && window.firebaseDb) {
                console.log('ğŸ” Firebaseì—ì„œ ì‚¬ìš©ì ê²€ìƒ‰ ì‹œë„...');
                // Firebase ì‚¬ìš©ì ê²€ìƒ‰ ë¡œì§ì€ ë³„ë„ë¡œ êµ¬í˜„ í•„ìš”
            }
            
            console.log('ğŸ‘¤ ì°¾ì€ ì‚¬ìš©ì:', user);
            
            if (!user) {
                console.error('âŒ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ. ì‚¬ìš© ê°€ëŠ¥í•œ IDë“¤:', users.map(u => ({ id: u.id, firebaseId: u.firebaseId, uid: u.uid, email: u.email })));
                alert(`ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nê²€ìƒ‰í•œ ID: ${userId}\n\nì½˜ì†”ì—ì„œ ìì„¸í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
                return;
            }
            
            // ëª¨ë‹¬ ë‚´ìš© ìƒì„±
            const content = document.getElementById('user-detail-content');
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- ê¸°ë³¸ ì •ë³´ -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ ê¸°ë³¸ ì •ë³´</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">ì´ë¦„:</span>
                                <span class="font-medium">${user.name || user.displayName || 'ì •ë³´ ì—†ìŒ'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">ì´ë©”ì¼:</span>
                                <span class="font-medium">${user.email || 'ì •ë³´ ì—†ìŒ'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">íœ´ëŒ€í°:</span>
                                <span class="font-medium">${user.phone || 'ì •ë³´ ì—†ìŒ'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">ë¡œê·¸ì¸ ë°©ì‹:</span>
                                <span class="px-2 py-1 rounded-full text-xs font-semibold ${(user.loginMethod || user.loginType) === 'kakao' ? 'bg-yellow-100 text-yellow-800' : 'bg-blue-100 text-blue-800'}">
                                    ${(user.loginMethod || user.loginType) === 'kakao' ? 'ì¹´ì¹´ì˜¤í†¡' : 'ì´ë©”ì¼'}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ê³„ì • ì •ë³´ -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ” ê³„ì • ì •ë³´</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">ì‚¬ìš©ì ID:</span>
                                <span class="font-mono text-sm">${user.id || user.firebaseId || 'ì •ë³´ ì—†ìŒ'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">í¬ì¸íŠ¸:</span>
                                <span class="font-medium text-green-600">${user.points || 0}P</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">ê°€ì…ì¼:</span>
                                <span class="font-medium">${user.createdAt ? new Date(user.createdAt).toLocaleDateString('ko-KR') : 'ì •ë³´ ì—†ìŒ'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">ë§ˆì§€ë§‰ ë¡œê·¸ì¸:</span>
                                <span class="font-medium">${user.lastLogin ? new Date(user.lastLogin).toLocaleDateString('ko-KR') : 'ì •ë³´ ì—†ìŒ'}</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ì¶”ê°€ ì •ë³´ -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“Š ì¶”ê°€ ì •ë³´</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="flex justify-between">
                            <span class="text-gray-600">ë°ì´í„° ì†ŒìŠ¤:</span>
                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${user.source === 'localStorage' ? 'bg-orange-100 text-orange-800' : 'bg-green-100 text-green-800'}">
                                ${user.source || 'Firebase'}
                            </span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ë¡œê·¸ì¸ íšŸìˆ˜:</span>
                            <span class="font-medium">${user.loginCount || 0}íšŒ</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ê³„ì • ìƒíƒœ:</span>
                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${user.isActive !== false ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                ${user.isActive !== false ? 'í™œì„±' : 'ë¹„í™œì„±'}
                            </span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ë§ˆì¼€íŒ… ë™ì˜:</span>
                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${user.agreeMarketing ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}">
                                ${user.agreeMarketing ? 'ë™ì˜' : 'ë¹„ë™ì˜'}
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- ì•½ê´€ ë™ì˜ ì •ë³´ -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“„ ì•½ê´€ ë™ì˜</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="flex justify-between">
                            <span class="text-gray-600">ì´ìš©ì•½ê´€:</span>
                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${user.agreeTerms ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                ${user.agreeTerms ? 'ë™ì˜' : 'ë¹„ë™ì˜'}
                            </span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨:</span>
                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${user.agreePrivacy ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                ${user.agreePrivacy ? 'ë™ì˜' : 'ë¹„ë™ì˜'}
                            </span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ë§ˆì¼€íŒ… ìˆ˜ì‹ :</span>
                            <span class="px-2 py-1 rounded-full text-xs font-semibold ${user.agreeMarketing ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}">
                                ${user.agreeMarketing ? 'ë™ì˜' : 'ë¹„ë™ì˜'}
                            </span>
                        </div>
                    </div>
                </div>
            `;
            
            // ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setupUserDetailModal(userId, user);
            
            // ëª¨ë‹¬ í‘œì‹œ
            document.getElementById('user-detail-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        
        // ì‚¬ìš©ì ìƒì„¸ë³´ê¸° ëª¨ë‹¬ ì„¤ì •
        function setupUserDetailModal(userId, user) {
            // ë‹«ê¸° ë²„íŠ¼ë“¤
            document.getElementById('close-user-detail').onclick = closeUserDetailModal;
            document.getElementById('close-user-detail-btn').onclick = closeUserDetailModal;
            
            // ìˆ˜ì • ë²„íŠ¼
            document.getElementById('edit-user-btn').onclick = function() {
                alert('ì‚¬ìš©ì ì •ë³´ ìˆ˜ì • ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
            };
            
            // ì‚­ì œ ë²„íŠ¼
            document.getElementById('delete-user-btn').onclick = function() {
                if (confirm(`ì •ë§ë¡œ ${user.name || user.displayName}ë‹˜ì˜ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                    deleteUser(userId);
                    closeUserDetailModal();
                }
            };
        }
        
        // ì‚¬ìš©ì ìƒì„¸ë³´ê¸° ëª¨ë‹¬ ë‹«ê¸°
        function closeUserDetailModal() {
            document.getElementById('user-detail-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        // ì‚¬ìš©ì ì‚­ì œ í•¨ìˆ˜ (Firebase ìë™ ì—°ë™)
        async function deleteUser(userId) {
            console.log('ğŸ—‘ï¸ ì‚¬ìš©ì ì‚­ì œ ì‹œì‘:', userId);
            
            // Firebaseì—ì„œ ì‚¬ìš©ì ì •ë³´ ë¨¼ì € ì°¾ê¸°
            let user = null;
            let firebaseUser = null;
            
            try {
                if (window.firebaseDb) {
                    const { collection, getDocs, query, where } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                    const usersRef = collection(window.firebaseDb, 'users');
                    
                    // ì´ë©”ì¼ë¡œ ê²€ìƒ‰ ì‹œë„
                    if (userId.includes('@')) {
                        const q = query(usersRef, where('email', '==', userId));
                        const snapshot = await getDocs(q);
                        if (!snapshot.empty) {
                            const doc = snapshot.docs[0];
                            firebaseUser = { id: doc.id, ...doc.data() };
                        }
                    }
                    
                    // IDë¡œ ì§ì ‘ ê²€ìƒ‰ ì‹œë„
                    if (!firebaseUser) {
                        const { doc, getDoc } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                        const userDocRef = doc(window.firebaseDb, 'users', userId);
                        const userDoc = await getDoc(userDocRef);
                        if (userDoc.exists()) {
                            firebaseUser = { id: userDoc.id, ...userDoc.data() };
                        }
                    }
                }
            } catch (error) {
                console.warn('âš ï¸ Firebaseì—ì„œ ì‚¬ìš©ì ê²€ìƒ‰ ì‹¤íŒ¨:', error);
            }
            
            // localStorageì—ì„œë„ ê²€ìƒ‰
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const localUser = users.find(u => 
                u.id === userId || 
                u.firebaseId === userId || 
                u.uid === userId ||
                u.email === userId
            );
            
            // Firebase ì‚¬ìš©ìë¥¼ ìš°ì„ ìœ¼ë¡œ ì‚¬ìš©
            user = firebaseUser || localUser;
            
            if (!user) {
                console.error('âŒ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:', userId);
                console.log('ğŸ“‹ localStorage ì‚¬ìš©ìë“¤:', users.map(u => ({ id: u.id, email: u.email })));
                alert(`ì‚­ì œí•  ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nê²€ìƒ‰í•œ ID: ${userId}\n\nì½˜ì†”ì—ì„œ ìì„¸í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
                return;
            }
            
            const userName = user.name || user.displayName || user.email;
            
            // ê´€ë¦¬ì ê³„ì • ë³´í˜¸
            if (user.email === 'admin@pricehunter.com') {
                alert('âŒ ê´€ë¦¬ì ê³„ì •ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì‚­ì œ í™•ì¸
            if (!confirm(`âš ï¸ ê²½ê³ : "${userName}"ë‹˜ì˜ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nì‚­ì œë  ë°ì´í„°:\n- Firebase ì‚¬ìš©ì ë¬¸ì„œ (ìë™ ì—°ë™)\n- localStorage ì‚¬ìš©ì ë°ì´í„°\n\nì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            try {
                console.log('ğŸ—‘ï¸ ì‚¬ìš©ì ì‚­ì œ ì§„í–‰ ì¤‘...');
                
                // 1. Firebaseì—ì„œ ì‚­ì œ (ìš°ì„ )
                if (window.firebaseDb && user.id) {
                    try {
                        const { doc, deleteDoc } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js');
                        const userDocRef = doc(window.firebaseDb, 'users', user.id);
                        await deleteDoc(userDocRef);
                        console.log('âœ… Firebaseì—ì„œ ì‚¬ìš©ì ì‚­ì œ ì™„ë£Œ:', user.id);
                    } catch (firebaseError) {
                        console.error('âŒ Firebase ì‚­ì œ ì‹¤íŒ¨:', firebaseError);
                        alert('âŒ Firebaseì—ì„œ ì‚¬ìš©ì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜: ' + firebaseError.message);
                        return;
                    }
                } else {
                    console.warn('âš ï¸ Firebase ì—°ê²°ì´ ì—†ê±°ë‚˜ ì‚¬ìš©ì IDê°€ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                // 2. localStorageì—ì„œ ì‚­ì œ (ì‚¬ìš©ì ì´ë©”ì¼ ê¸°ì¤€ìœ¼ë¡œ ì‚­ì œ)
                const updatedUsers = users.filter(u => u.email !== user.email);
                localStorage.setItem('users', JSON.stringify(updatedUsers));
                console.log('âœ… localStorageì—ì„œ ì‚¬ìš©ì ì‚­ì œ ì™„ë£Œ');
                
                // 3. ê°œë³„ user ë°ì´í„°ë„ ì‚­ì œ (ë§Œì•½ ìˆë‹¤ë©´)
                const individualUser = localStorage.getItem('user');
                if (individualUser) {
                    const parsedUser = JSON.parse(individualUser);
                    if (parsedUser.email === user.email) {
                        localStorage.removeItem('user');
                        console.log('âœ… ê°œë³„ user ë°ì´í„° ì‚­ì œ ì™„ë£Œ');
                    }
                }
                
                // 4. UI ì—…ë°ì´íŠ¸
                alert(`âœ… "${userName}"ë‹˜ì˜ ê³„ì •ì´ ì™„ì „íˆ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\n\n- Firebase: ì‚­ì œ ì™„ë£Œ (ìë™ ì—°ë™)\n- localStorage: ì‚­ì œ ì™„ë£Œ`);
                
                // 5. íšŒì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                if (typeof subscribeToUsers === 'function') {
                    subscribeToUsers();
                }
                
                // 6. í†µê³„ ì—…ë°ì´íŠ¸
                setTimeout(() => {
                    const allUsers = JSON.parse(localStorage.getItem('users') || '[]');
                    const totalMembersElement = document.getElementById('total-members');
                    if (totalMembersElement) {
                        totalMembersElement.textContent = allUsers.length;
                    }
                    
                    // í†µê³„ ì—…ë°ì´íŠ¸
                    if (typeof updateMemberStats === 'function') {
                        updateMemberStats(allUsers);
                    }
                }, 1000);
                
                console.log('âœ… ì‚¬ìš©ì ì‚­ì œ ì™„ë£Œ');
                
            } catch (error) {
                console.error('âŒ ì‚¬ìš©ì ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('âŒ ì‚¬ìš©ì ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜: ' + error.message);
            }
        }

        // ì„¹ì…˜ ì „í™˜
        function switchSection(section) {
            // ê¸°ì¡´ í™œì„± ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.section-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // ê¸°ì¡´ í™œì„± ì‚¬ì´ë“œë°” ì•„ì´í…œ ë¹„í™œì„±í™”
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ìƒˆ ì„¹ì…˜ í‘œì‹œ
            const targetSection = document.getElementById(section + '-section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // ìƒˆ ì‚¬ì´ë“œë°” ì•„ì´í…œ í™œì„±í™”
            const activeItem = document.querySelector(`[data-section="${section}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
            
            // íšŒì› ê´€ë¦¬ ì„¹ì…˜ì¸ ê²½ìš° ì‹¤ì‹œê°„ êµ¬ë… ì‹œì‘ (ì´ë¯¸ ì‹œì‘ë˜ì–´ ìˆìœ¼ë©´ ë¬´ì‹œ)
            if (section === 'members' && !usersUnsubscribe) {
                subscribeToUsers();
            }
            
            // í›„ê¸° ê´€ë¦¬ ì„¹ì…˜ì¸ ê²½ìš° í›„ê¸° ë°ì´í„° ë¡œë“œ
            if (section === 'reviews') {
                loadReviewsData();
            }
        }

        // í›„ê¸° ê´€ë¦¬ í•¨ìˆ˜ë“¤
        let allReviews = [];
        let filteredReviews = [];

        // í›„ê¸° ë°ì´í„° ë¡œë“œ
        async function loadReviewsData() {
            try {
                console.log('ğŸ“‹ í›„ê¸° ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                
                if (!window.firebaseDb) {
                    console.error('âŒ Firebaseê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                    return;
                }

                const { collection, getDocs } = window.firebaseFirestoreFunctions;
                const reviewsRef = collection(window.firebaseDb, 'reviews');
                const snapshot = await getDocs(reviewsRef);
                
                allReviews = [];
                snapshot.forEach(doc => {
                    allReviews.push({ id: doc.id, ...doc.data() });
                });
                
                // í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ì •ë ¬ (ìµœì‹ ìˆœ)
                allReviews.sort((a, b) => {
                    const dateA = a.createdAt ? new Date(a.createdAt.seconds * 1000) : new Date(a.purchaseDate || 0);
                    const dateB = b.createdAt ? new Date(b.createdAt.seconds * 1000) : new Date(b.purchaseDate || 0);
                    return dateB - dateA;
                });
                
                filteredReviews = [...allReviews];
                updateReviewStatistics();
                displayReviewsTable();
                
                console.log(`âœ… í›„ê¸° ë°ì´í„° ë¡œë“œ ì™„ë£Œ: ${allReviews.length}ê°œ`);
                
            } catch (error) {
                console.error('âŒ í›„ê¸° ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                alert('í›„ê¸° ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // í›„ê¸° í†µê³„ ì—…ë°ì´íŠ¸
        function updateReviewStatistics() {
            const totalReviews = allReviews.length;
            const approvedReviews = allReviews.filter(r => r.approved === true).length;
            const pendingReviews = allReviews.filter(r => r.approved === false && r.rejected !== true).length;
            const rejectedReviews = allReviews.filter(r => r.rejected === true).length;

            const stats = document.getElementById('review-stats');
            if (stats) {
                stats.innerHTML = `
                    <div class="text-center">
                        <div class="font-bold text-lg text-blue-600">${totalReviews}</div>
                        <div class="text-gray-600">ì´ í›„ê¸°</div>
                    </div>
                    <div class="text-center">
                        <div class="font-bold text-lg text-green-600">${approvedReviews}</div>
                        <div class="text-gray-600">ìŠ¹ì¸ëœ í›„ê¸°</div>
                    </div>
                    <div class="text-center">
                        <div class="font-bold text-lg text-yellow-600">${pendingReviews}</div>
                        <div class="text-gray-600">ëŒ€ê¸° ì¤‘</div>
                    </div>
                    <div class="text-center">
                        <div class="font-bold text-lg text-red-600">${rejectedReviews}</div>
                        <div class="text-gray-600">ê±°ë¶€ëœ í›„ê¸°</div>
                    </div>
                `;
            }
        }

        // í›„ê¸° í…Œì´ë¸” í‘œì‹œ
        function displayReviewsTable() {
            const tbody = document.getElementById('reviews-table-body');
            if (!tbody) return;

            if (filteredReviews.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="px-6 py-4 text-center text-gray-500">
                            í›„ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = filteredReviews.map(review => {
                const statusBadge = getStatusBadge(review);
                const stars = 'â˜…'.repeat(review.rating || 5) + 'â˜†'.repeat(5 - (review.rating || 5));
                
                return `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <img src="${review.profileImage || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=100&q=80'}" 
                                 alt="${review.name}" class="w-10 h-10 rounded-full object-cover">
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${review.name}</div>
                            <div class="text-sm text-gray-500">${review.ageGroup} â€¢ ${review.occupation}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">${review.productName}</div>
                            <div class="text-sm text-gray-500">${review.category}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-red-600">${review.savings}</div>
                            <div class="text-sm text-gray-500">${review.savingsPercent}%</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-yellow-500">${stars}</div>
                            <div class="text-sm text-gray-500">${review.rating || 5}/5</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            ${statusBadge}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${formatDate(review.createdAt || review.purchaseDate)}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button onclick="viewReviewDetails('${review.id}')" class="text-blue-600 hover:text-blue-900">ë³´ê¸°</button>
                                <button onclick="editReview('${review.id}')" class="text-green-600 hover:text-green-900">ìˆ˜ì •</button>
                                <button onclick="deleteReview('${review.id}')" class="text-red-600 hover:text-red-900">ì‚­ì œ</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ìƒíƒœ ë°°ì§€ ìƒì„±
        function getStatusBadge(review) {
            if (review.approved === true) {
                return '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">ìŠ¹ì¸ë¨</span>';
            } else if (review.rejected === true) {
                return '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">ê±°ë¶€ë¨</span>';
            } else {
                return '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">ëŒ€ê¸° ì¤‘</span>';
            }
        }

        // ë‚ ì§œ í¬ë§·íŒ…
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        // í›„ê¸° ìƒì„¸ë³´ê¸°
        function viewReviewDetails(reviewId) {
            const review = allReviews.find(r => r.id === reviewId);
            if (!review) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto relative">
                    <button onclick="this.closest('.fixed').remove()" class="absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
                    <h2 class="text-2xl font-bold text-center mb-6 text-gray-700">â­ í›„ê¸° ìƒì„¸ì •ë³´</h2>
                    
                    <div class="space-y-6">
                        <div class="flex items-center space-x-4">
                            <img src="${review.profileImage || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=100&q=80'}" 
                                 alt="${review.name}" class="w-16 h-16 rounded-full object-cover">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${review.name}</h3>
                                <p class="text-gray-500">${review.ageGroup} â€¢ ${review.occupation}</p>
                                <div class="flex items-center text-yellow-500">
                                    ${'â˜…'.repeat(review.rating || 5)}${'â˜†'.repeat(5 - (review.rating || 5))}
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900 mb-2">${review.productName}</h4>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-600">ì›ê°€:</span>
                                    <span class="line-through">${review.originalPrice}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">êµ¬ë§¤ê°€:</span>
                                    <span class="font-semibold text-green-600">${review.finalPrice}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">ì ˆì•½:</span>
                                    <span class="font-semibold text-red-600">${review.savings}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">ì ˆì•½ìœ¨:</span>
                                    <span class="font-semibold text-red-600">${review.savingsPercent}%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-gray-900 mb-2">í›„ê¸° ë‚´ìš©</h4>
                            <p class="text-gray-700 bg-gray-50 rounded-lg p-4">${review.review}</p>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-600">ì¹´í…Œê³ ë¦¬:</span>
                                <span class="font-semibold">${review.category}</span>
                            </div>
                            <div>
                                <span class="text-gray-600">êµ¬ë§¤ì¼:</span>
                                <span class="font-semibold">${formatDate(review.purchaseDate)}</span>
                            </div>
                            <div>
                                <span class="text-gray-600">ë°°ì†¡:</span>
                                <span class="font-semibold">${review.shipping}</span>
                            </div>
                            <div>
                                <span class="text-gray-600">êµ¬ë§¤ë°©ë²•:</span>
                                <span class="font-semibold">${review.method}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end gap-3">
                        <button onclick="approveReview('${review.id}')" class="px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition">
                            âœ… ìŠ¹ì¸
                        </button>
                        <button onclick="rejectReview('${review.id}')" class="px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition">
                            âŒ ê±°ë¶€
                        </button>
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition">
                            ë‹«ê¸°
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // í›„ê¸° ìŠ¹ì¸
        async function approveReview(reviewId) {
            try {
                const { doc, updateDoc } = window.firebaseFirestoreFunctions;
                const reviewRef = doc(window.firebaseDb, 'reviews', reviewId);
                await updateDoc(reviewRef, {
                    approved: true,
                    rejected: false,
                    updatedAt: new Date()
                });
                
                alert('í›„ê¸°ê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadReviewsData();
                
            } catch (error) {
                console.error('í›„ê¸° ìŠ¹ì¸ ì‹¤íŒ¨:', error);
                alert('í›„ê¸° ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // í›„ê¸° ê±°ë¶€
        async function rejectReview(reviewId) {
            try {
                const { doc, updateDoc } = window.firebaseFirestoreFunctions;
                const reviewRef = doc(window.firebaseDb, 'reviews', reviewId);
                await updateDoc(reviewRef, {
                    approved: false,
                    rejected: true,
                    updatedAt: new Date()
                });
                
                alert('í›„ê¸°ê°€ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadReviewsData();
                
            } catch (error) {
                console.error('í›„ê¸° ê±°ë¶€ ì‹¤íŒ¨:', error);
                alert('í›„ê¸° ê±°ë¶€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // í›„ê¸° ì‚­ì œ
        async function deleteReview(reviewId) {
            if (!confirm('ì •ë§ë¡œ ì´ í›„ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                const { doc, deleteDoc } = window.firebaseFirestoreFunctions;
                const reviewRef = doc(window.firebaseDb, 'reviews', reviewId);
                await deleteDoc(reviewRef);
                
                alert('í›„ê¸°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadReviewsData();
                
            } catch (error) {
                console.error('í›„ê¸° ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('í›„ê¸° ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ìƒˆ í›„ê¸° ì¶”ê°€
        function addNewReview() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto relative">
                    <button onclick="this.closest('.fixed').remove()" class="absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
                    <h2 class="text-2xl font-bold text-center mb-6 text-gray-700">â• ìƒˆ í›„ê¸° ì¶”ê°€</h2>
                    
                    <form id="new-review-form" class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ì‘ì„±ìëª…</label>
                                <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ì—°ë ¹ëŒ€</label>
                                <select name="ageGroup" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="10ëŒ€">10ëŒ€</option>
                                    <option value="20ëŒ€">20ëŒ€</option>
                                    <option value="30ëŒ€">30ëŒ€</option>
                                    <option value="40ëŒ€">40ëŒ€</option>
                                    <option value="50ëŒ€">50ëŒ€</option>
                                    <option value="60ëŒ€">60ëŒ€</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ì§ì—…</label>
                                <input type="text" name="occupation" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ìƒí’ˆëª…</label>
                                <input type="text" name="productName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ì¹´í…Œê³ ë¦¬</label>
                                <select name="category" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="ì „ìì œí’ˆ">ì „ìì œí’ˆ</option>
                                    <option value="ì˜ë¥˜">ì˜ë¥˜</option>
                                    <option value="í™”ì¥í’ˆ">í™”ì¥í’ˆ</option>
                                    <option value="ìƒí™œìš©í’ˆ">ìƒí™œìš©í’ˆ</option>
                                    <option value="ì‹í’ˆ">ì‹í’ˆ</option>
                                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ë³„ì </label>
                                <select name="rating" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="5">5ì </option>
                                    <option value="4">4ì </option>
                                    <option value="3">3ì </option>
                                    <option value="2">2ì </option>
                                    <option value="1">1ì </option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ì›ê°€</label>
                                <input type="text" name="originalPrice" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">êµ¬ë§¤ê°€</label>
                                <input type="text" name="finalPrice" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">ì ˆì•½ê¸ˆì•¡</label>
                                <input type="text" name="savings" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">í›„ê¸° ë‚´ìš©</label>
                            <textarea name="review" required rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        
                        <div class="flex justify-end gap-3">
                            <button type="button" onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition">
                                ì·¨ì†Œ
                            </button>
                            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition">
                                ì¶”ê°€
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            
            // í¼ ì œì¶œ ì´ë²¤íŠ¸
            document.getElementById('new-review-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const reviewData = Object.fromEntries(formData);
                
                try {
                    const { collection, addDoc, serverTimestamp } = window.firebaseFirestoreFunctions;
                    const reviewsRef = collection(window.firebaseDb, 'reviews');
                    
                    await addDoc(reviewsRef, {
                        ...reviewData,
                        savingsPercent: Math.round((parseInt(reviewData.savings.replace(/[^0-9]/g, '')) / parseInt(reviewData.originalPrice.replace(/[^0-9]/g, ''))) * 100),
                        approved: true,
                        rejected: false,
                        country: 'ëŒ€í•œë¯¼êµ­',
                        shipping: '2ì¼',
                        method: 'ê³µì¥ ì§ì ‘êµ¬ë§¤',
                        badge: 'ì‹¤ì œ êµ¬ë§¤ì',
                        stars: parseInt(reviewData.rating),
                        views: 0,
                        createdAt: serverTimestamp(),
                        updatedAt: serverTimestamp()
                    });
                    
                    alert('ìƒˆ í›„ê¸°ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    modal.remove();
                    loadReviewsData();
                    
                } catch (error) {
                    console.error('í›„ê¸° ì¶”ê°€ ì‹¤íŒ¨:', error);
                    alert('í›„ê¸° ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            });
        }

        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
        window.switchSection = switchSection;
        window.viewUserDetails = viewUserDetails;
        window.deleteUser = deleteUser;
        window.loadReviewsData = loadReviewsData;
        window.viewReviewDetails = viewReviewDetails;
        window.approveReview = approveReview;
        window.rejectReview = rejectReview;
        window.deleteReview = deleteReview;
        window.addNewReview = addNewReview;
        
        // ì´ˆê¸° í›„ê¸° ë°ì´í„° ìƒì„± í•¨ìˆ˜ (init-reviews-data.jsì—ì„œ ê°€ì ¸ì˜´)
        window.initializeReviewsData = async function() {
            try {
                console.log('ğŸš€ í›„ê¸° ë°ì´í„° ì´ˆê¸°í™” ì‹œì‘...');
                
                if (!window.firebaseDb) {
                    throw new Error('Firebaseê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                const { collection, addDoc, serverTimestamp } = window.firebaseFirestoreFunctions;
                const reviewsRef = collection(window.firebaseDb, 'reviews');
                
                const initialReviewsData = [
                    {
                        name: "ê¹€ì˜í¬",
                        ageGroup: "30ëŒ€",
                        occupation: "ë””ìì´ë„ˆ",
                        profileImage: "https://images.unsplash.com/photo-1494790108755-2616b612b786?auto=format&fit=crop&w=100&q=80",
                        productName: "MacBook Pro 14ì¸ì¹˜",
                        category: "ì „ìì œí’ˆ",
                        brand: "Apple",
                        originalPrice: "2,890,000ì›",
                        finalPrice: "1,890,000ì›",
                        savings: "1,000,000ì›",
                        savingsPercent: 35,
                        rating: 5,
                        review: "ìš”ì²­ê°€ 289ë§Œì› â†’ 189ë§Œì›ìœ¼ë¡œ êµ¬ë§¤! ì„±ëŠ¥ë„ í›Œë¥­í•˜ê³  ì •ë§ ë§Œì¡±í•©ë‹ˆë‹¤. PriceHunter ë•ë¶„ì— 100ë§Œì›ì´ë‚˜ ì ˆì•½í–ˆì–´ìš”!",
                        purchaseDate: "2024-01-15",
                        country: "ëŒ€í•œë¯¼êµ­",
                        shipping: "2ì¼",
                        method: "ê³µì¥ ì§ì ‘êµ¬ë§¤",
                        badge: "ì‹¤ì œ êµ¬ë§¤ì",
                        stars: 5,
                        approved: true,
                        views: 1250
                    },
                    {
                        name: "ì´ì² ìˆ˜",
                        ageGroup: "40ëŒ€",
                        occupation: "ìì˜ì—…ì",
                        profileImage: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=100&q=80",
                        productName: "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24 Ultra",
                        category: "ì „ìì œí’ˆ",
                        brand: "Samsung",
                        originalPrice: "1,650,000ì›",
                        finalPrice: "1,200,000ì›",
                        savings: "450,000ì›",
                        savingsPercent: 27,
                        rating: 5,
                        review: "ì‚¬ë¬´ìš©í’ˆ ëŒ€ëŸ‰êµ¬ë§¤ ì„±ê³µ! ìš”ì²­ê°€ 165ë§Œì› â†’ 120ë§Œì›ìœ¼ë¡œ ì ˆì•½! ë¹ ë¥¸ ë°°ì†¡, ì €ë ´í•œ ê°€ê²©!",
                        purchaseDate: "2024-01-20",
                        country: "ëŒ€í•œë¯¼êµ­",
                        shipping: "2ì¼",
                        method: "ê³µì¥ ì§ì ‘êµ¬ë§¤",
                        badge: "ì‚¬ì—…ì ëŒ€ëŸ‰êµ¬ë§¤",
                        stars: 5,
                        approved: true,
                        views: 980
                    },
                    {
                        name: "ë°•ë¯¼ìˆ˜",
                        ageGroup: "20ëŒ€",
                        occupation: "ëŒ€í•™ìƒ",
                        profileImage: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=100&q=80",
                        productName: "iPad Air 5ì„¸ëŒ€",
                        category: "ì „ìì œí’ˆ",
                        brand: "Apple",
                        originalPrice: "899,000ì›",
                        finalPrice: "650,000ì›",
                        savings: "249,000ì›",
                        savingsPercent: 28,
                        rating: 5,
                        review: "íƒœë¸”ë¦¿ì„ ì‹¸ê²Œ ìƒ€ì–´ìš”! ìš”ì²­ê°€ 89.9ë§Œì› â†’ 65ë§Œì›ìœ¼ë¡œ êµ¬ë§¤! í•™ìƒ í• ì¸ê¹Œì§€ ë°›ì•„ì„œ êµ¿!",
                        purchaseDate: "2024-01-25",
                        country: "ëŒ€í•œë¯¼êµ­",
                        shipping: "4ì¼",
                        method: "ê³µì¥ ì§ì ‘êµ¬ë§¤",
                        badge: "ì‹¤ì œ êµ¬ë§¤ì",
                        stars: 4.8,
                        approved: true,
                        views: 756
                    },
                    {
                        name: "ìµœì§€ì€",
                        ageGroup: "30ëŒ€",
                        occupation: "ì£¼ë¶€",
                        profileImage: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&w=100&q=80",
                        productName: "ë‹¤ì´ìŠ¨ V15 ë¬´ì„ ì²­ì†Œê¸°",
                        category: "ìƒí™œìš©í’ˆ",
                        brand: "Dyson",
                        originalPrice: "899,000ì›",
                        finalPrice: "650,000ì›",
                        savings: "249,000ì›",
                        savingsPercent: 28,
                        rating: 5,
                        review: "ê°€ì „ì œí’ˆ ì €ë ´í•˜ê²Œ êµ¬ì…! ìš”ì²­ê°€ 89.9ë§Œì› â†’ 65ë§Œì›ìœ¼ë¡œ ì ˆì•½! ë¯¿ê³  êµ¬ë§¤í–ˆì–´ìš”.",
                        purchaseDate: "2024-01-28",
                        country: "ëŒ€í•œë¯¼êµ­",
                        shipping: "3ì¼",
                        method: "ë„ë§¤ì²˜ ì—°ë™",
                        badge: "ì‹¤ì œ êµ¬ë§¤ì",
                        stars: 5,
                        approved: true,
                        views: 892
                    },
                    {
                        name: "ì •ìš°ì„±",
                        ageGroup: "40ëŒ€",
                        occupation: "ì§ì¥ì¸",
                        profileImage: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=100&q=80",
                        productName: "ë¡œì§€í… MX Master 3S",
                        category: "ì „ìì œí’ˆ",
                        brand: "Logitech",
                        originalPrice: "149,000ì›",
                        finalPrice: "89,000ì›",
                        savings: "60,000ì›",
                        savingsPercent: 40,
                        rating: 5,
                        review: "ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ ë“í…œ! ìš”ì²­ê°€ 14.9ë§Œì› â†’ 8.9ë§Œì›ìœ¼ë¡œ ì ˆì•½! ê¸°ëŠ¥ë„ ë§ê³  ì €ë ´!",
                        purchaseDate: "2024-02-01",
                        country: "ëŒ€í•œë¯¼êµ­",
                        shipping: "2ì¼",
                        method: "ê³µì¥ ì§ì ‘êµ¬ë§¤",
                        badge: "ì‹¤ì œ êµ¬ë§¤ì",
                        stars: 4.7,
                        approved: true,
                        views: 634
                    }
                ];
                
                let successCount = 0;
                
                for (const reviewData of initialReviewsData) {
                    try {
                        const docData = {
                            ...reviewData,
                            createdAt: serverTimestamp(),
                            updatedAt: serverTimestamp()
                        };
                        
                        await addDoc(reviewsRef, docData);
                        successCount++;
                        console.log(`âœ… í›„ê¸° ì¶”ê°€ ì™„ë£Œ: ${reviewData.name} - ${reviewData.productName}`);
                        
                    } catch (error) {
                        console.error(`âŒ í›„ê¸° ì¶”ê°€ ì‹¤íŒ¨: ${reviewData.name}`, error);
                    }
                }
                
                console.log(`ğŸ‰ í›„ê¸° ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ! ì´ ${successCount}ê°œ í›„ê¸° ì¶”ê°€ë¨`);
                alert(`í›„ê¸° ë°ì´í„° ì´ˆê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ ${successCount}ê°œì˜ í›„ê¸°ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                
                // í›„ê¸° ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                if (typeof loadReviewsData === 'function') {
                    loadReviewsData();
                }
                
                return successCount;
                
            } catch (error) {
                console.error('âŒ í›„ê¸° ë°ì´í„° ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                alert('í›„ê¸° ë°ì´í„° ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                return 0;
            }
        };
        
        console.log('ğŸš€ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ');
    </script>
    
    <style>
        body { font-family: 'Inter', 'Noto Sans KR', sans-serif; }
        .sidebar-item.active { background-color: #ec4899; color: white; }
        .tab-btn.active { background-color: #ec4899; color: white; }
        .filter-btn.active { background-color: #6b7280; color: white; }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 via-blue-50 to-emerald-50 min-h-screen">
    <!-- ë¡œê·¸ì¸ ì„¹ì…˜ -->
    <div id="login-section" class="min-h-screen flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl p-4 sm:p-6 md:p-8 w-full max-w-xs sm:max-w-sm md:max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-pink-600">PriceHunter</h1>
                <p class="text-gray-600">ê´€ë¦¬ì ë¡œê·¸ì¸</p>
            </div>
            
            <form onsubmit="event.preventDefault(); adminLogin();" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ì´ë©”ì¼</label>
                    <input type="email" id="admin-email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-400 focus:outline-none" placeholder="admin@pricehunter.com">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="admin-password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-400 focus:outline-none" placeholder="ë¹„ë°€ë²ˆí˜¸">
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-pink-500 to-purple-500 text-white font-bold py-3 px-4 rounded-lg hover:from-pink-600 hover:to-purple-600 transition shadow-lg">
                    ğŸ” ë¡œê·¸ì¸
                </button>
            </form>
            
            <div class="mt-6 text-center space-y-3">
                <button onclick="goToPage('index.html')" class="text-pink-600 hover:text-pink-700 text-sm block w-full">
                    ğŸ  ë©”ì¸í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
                </button>
                <button onclick="createAdminAccount()" class="text-blue-600 hover:text-blue-700 text-sm block w-full">
                    ğŸ”§ í…ŒìŠ¤íŠ¸ ê´€ë¦¬ì ê³„ì • ìƒì„±
                </button>
                <div class="text-xs text-gray-500 mt-2">
                    í…ŒìŠ¤íŠ¸ìš© ê³„ì •: admin@pricehunter.com / admin1234
                </div>
            </div>
        </div>
    </div>

    <!-- ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ -->
    <div id="dashboard-section" class="hidden">
        <div class="flex h-screen">
            <!-- ì‚¬ì´ë“œë°” -->
            <div class="w-64 bg-white shadow-lg">
                <div class="p-6 border-b">
                    <h1 class="text-xl font-bold text-pink-600">PriceHunter</h1>
                    <p class="text-sm text-gray-500">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</p>
                    <p id="admin-info" class="text-xs text-gray-400 mt-1"></p>
                </div>
                
                <nav class="p-4">
                    <div class="space-y-2">
                        <button class="sidebar-item w-full text-left px-4 py-3 rounded-lg font-semibold hover:bg-pink-50 transition active" data-section="dashboard" onclick="switchSection('dashboard')">
                            ğŸ“Š ëŒ€ì‹œë³´ë“œ
                        </button>
                        <button class="sidebar-item w-full text-left px-4 py-3 rounded-lg font-semibold hover:bg-pink-50 transition" data-section="requests" onclick="switchSection('requests')">
                            ğŸ“‹ ì˜ë¢° ê´€ë¦¬
                        </button>
                        <button class="sidebar-item w-full text-left px-4 py-3 rounded-lg font-semibold hover:bg-pink-50 transition" data-section="inquiries" onclick="switchSection('inquiries')">
                            ğŸ’¬ 1:1 ë¬¸ì˜
                        </button>
                        <button class="sidebar-item w-full text-left px-4 py-3 rounded-lg font-semibold hover:bg-pink-50 transition" data-section="members" onclick="switchSection('members')">
                            ğŸ‘¥ íšŒì› ê´€ë¦¬
                        </button>
                        <button class="sidebar-item w-full text-left px-4 py-3 rounded-lg font-semibold hover:bg-pink-50 transition" data-section="reviews" onclick="switchSection('reviews')">
                            â­ í›„ê¸° ê´€ë¦¬
                        </button>
                    </div>
                </nav>
                
                <div class="absolute bottom-4 left-4 right-4">
                    <button onclick="adminLogout()" class="w-full px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition">
                        ğŸ”“ ë¡œê·¸ì•„ì›ƒ
                    </button>
                </div>
            </div>

            <!-- ë©”ì¸ ì½˜í…ì¸  -->
            <div class="flex-1 overflow-auto">
                <!-- ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ -->
                <div id="dashboard-content" class="section-content p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ“Š ëŒ€ì‹œë³´ë“œ</h2>
                        <div class="flex gap-2 flex-wrap">
                            <button onclick="goToPage('index.html')" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                                ğŸ  ë©”ì¸í˜ì´ì§€ë¡œ
                            </button>
                            <button onclick="goToPage('member-dashboard.html')" class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition">
                                ğŸ‘¤ íšŒì›ëŒ€ì‹œë³´ë“œë¡œ
                            </button>
                            <button onclick="testFirebaseConnection()" class="px-4 py-2 bg-purple-500 text-white rounded-lg font-semibold hover:bg-purple-600 transition">
                                ğŸ”¥ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸
                            </button>
                            <button onclick="checkFirebaseUsers()" class="px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition">
                                ğŸ” Firebase ì‚¬ìš©ì í™•ì¸
                            </button>
                            <button onclick="cleanupDuplicateUsers()" class="px-4 py-2 bg-pink-500 text-white rounded-lg font-semibold hover:bg-pink-600 transition">
                                ğŸ§¹ ì¤‘ë³µ ì‚¬ìš©ì ì •ë¦¬
                            </button>
                            <button onclick="checkCSPHeaders()" class="px-4 py-2 bg-indigo-500 text-white rounded-lg font-semibold hover:bg-indigo-600 transition">
                                ğŸ” CSP í—¤ë” í™•ì¸
                            </button>
                            <button onclick="clearCacheAndReload()" class="px-4 py-2 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition">
                                ğŸ§¹ ìºì‹œ ì •ë¦¬ & ìƒˆë¡œê³ ì¹¨
                            </button>
                        </div>
                    </div>
                    
                    <!-- í†µê³„ ì¹´ë“œ -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-3 bg-blue-100 rounded-lg">
                                    <span class="text-2xl">ğŸ“‹</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-500">ì´ ì˜ë¢°</p>
                                    <p class="text-2xl font-bold text-gray-800" id="total-requests">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-3 bg-green-100 rounded-lg">
                                    <span class="text-2xl">âœ…</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-500">ì™„ë£Œëœ ì˜ë¢°</p>
                                    <p class="text-2xl font-bold text-gray-800" id="completed-requests">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-3 bg-orange-100 rounded-lg">
                                    <span class="text-2xl">ğŸ‘¥</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-500">ì´ íšŒì›</p>
                                    <p class="text-2xl font-bold text-gray-800" id="total-members">0</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-3 bg-purple-100 rounded-lg">
                                    <span class="text-2xl">ğŸ’¬</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-500">ë¯¸ë‹µë³€ ë¬¸ì˜</p>
                                    <p class="text-2xl font-bold text-gray-800" id="pending-inquiries">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ìµœê·¼ í™œë™ -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">ìµœê·¼ ì˜ë¢°</h3>
                            <div id="recent-requests" class="space-y-3">
                                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">ìµœê·¼ ë¬¸ì˜</h3>
                            <div id="recent-inquiries" class="space-y-3">
                                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì˜ë¢° ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="requests-section" class="section-content p-8 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ“‹ ì˜ë¢° ê´€ë¦¬</h2>
                        <div class="flex gap-2">
                            <button onclick="goToPage('index.html')" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                                ğŸ  ë©”ì¸í˜ì´ì§€ë¡œ
                            </button>
                            <button onclick="goToPage('request.html')" class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition">
                                ğŸ“ ì˜ë¢°í˜ì´ì§€ë¡œ
                            </button>
                        </div>
                    </div>
                    
                    <!-- ì˜ë¢° ëª©ë¡ -->
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                        <div class="font-bold text-gray-700 p-4 border-b">ì ‘ìˆ˜ëœ ì˜ë¢° ëª©ë¡</div>
                        <div class="grid grid-cols-8 gap-2 px-4 py-2 bg-pink-100 text-sm font-bold text-pink-700">
                            <div class="col-span-1">ì„ íƒ</div>
                            <div class="col-span-2">ì˜ë¢°ë²ˆí˜¸/íšŒì›ëª…</div>
                            <div class="col-span-1 text-center">ì˜ë¢°ì¼ì‹œ</div>
                            <div class="col-span-1 text-center">ì§„í–‰ìƒí™©</div>
                            <div class="col-span-1 text-center">êµ¬ë§¤ë°©ì‹</div>
                            <div class="col-span-1 text-center">êµ¬ë§¤ìƒíƒœ</div>
                            <div class="col-span-1 text-center">ì•Œë¦¼ìƒíƒœ</div>
                        </div>
                        <ul id="request-list" class="bg-pink-50 divide-y divide-pink-100">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                        </ul>
                    </div>
                    
                    <!-- ì˜ë¢° ìƒì„¸ ë° ê²°ê³¼ ì…ë ¥ -->
                    <div id="detail-section" class="w-full hidden mt-6">
                        <div class="bg-white rounded-xl shadow-lg p-6 mb-4">
                            <div class="mb-2 text-gray-700 font-bold">ì˜ë¢° ìƒì„¸</div>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div><span class="font-semibold">ì˜ë¢°ë²ˆí˜¸:</span> <span id="detail-num"></span></div>
                                <div><span class="font-semibold">ì œí’ˆëª…:</span> <span id="detail-name"></span></div>
                                <div><span class="font-semibold">ì œí’ˆì„¤ëª…:</span> <span id="detail-desc"></span></div>
                                <div><span class="font-semibold">ì°¸ê³ ì‚¬ì´íŠ¸:</span> <span id="detail-url"></span></div>
                                <div><span class="font-semibold">ê°€ê²©:</span> <span id="detail-price"></span></div>
                                <div><span class="font-semibold">ì´ë¦„:</span> <span id="detail-username"></span></div>
                                <div><span class="font-semibold">ì´ë©”ì¼:</span> <span id="detail-email"></span></div>
                                <div><span class="font-semibold">íœ´ëŒ€í°:</span> <span id="detail-phone"></span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 1:1 ë¬¸ì˜ ì„¹ì…˜ -->
                <div id="inquiries-section" class="section-content p-8 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ’¬ 1:1 ë¬¸ì˜ ê´€ë¦¬</h2>
                        <div class="flex gap-2">
                            <button onclick="goToPage('index.html')" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                                ğŸ  ë©”ì¸í˜ì´ì§€ë¡œ
                            </button>
                            <button onclick="goToPage('support.html')" class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition">
                                ğŸ’¬ ë¬¸ì˜í˜ì´ì§€ë¡œ
                            </button>
                        </div>
                    </div>
                    
                    <!-- ë¬¸ì˜ ëª©ë¡ -->
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-blue-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">ë¬¸ì˜ë²ˆí˜¸</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">íšŒì›ëª…</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">ì œëª©</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">ìƒíƒœ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">ë“±ë¡ì¼ì‹œ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="inquiries-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- ë¬¸ì˜ ìƒì„¸ ë° ë‹µë³€ -->
                    <div id="inquiry-detail-section" class="w-full hidden mt-6">
                        <div class="bg-white rounded-xl shadow-lg p-6 mb-4">
                            <div class="mb-4">
                                <h3 class="text-lg font-bold text-gray-800 mb-2">ë¬¸ì˜ ìƒì„¸</h3>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div><span class="font-semibold">ë¬¸ì˜ë²ˆí˜¸:</span> <span id="inquiry-id"></span></div>
                                    <div><span class="font-semibold">ì œëª©:</span> <span id="inquiry-title"></span></div>
                                    <div><span class="font-semibold">íšŒì›ëª…:</span> <span id="inquiry-username"></span></div>
                                    <div><span class="font-semibold">ì´ë©”ì¼:</span> <span id="inquiry-email"></span></div>
                                    <div><span class="font-semibold">ì „í™”ë²ˆí˜¸:</span> <span id="inquiry-phone"></span></div>
                                    <div><span class="font-semibold">ë¬¸ì˜ì¼ì‹œ:</span> <span id="inquiry-date"></span></div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <h4 class="font-semibold text-gray-700 mb-2">ë¬¸ì˜ ë‚´ìš©</h4>
                                <div id="inquiry-content" class="bg-gray-50 p-4 rounded-lg text-gray-700"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- íšŒì› ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="members-section" class="section-content p-8 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ‘¥ íšŒì› ê´€ë¦¬</h2>
                        <div class="flex gap-2">
                            <button onclick="loadLocalStorageUsers()" class="px-4 py-2 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition">
                                ğŸ”„ localStorage ìƒˆë¡œê³ ì¹¨
                            </button>
                            <button onclick="goToPage('index.html')" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                                ğŸ  ë©”ì¸í˜ì´ì§€ë¡œ
                            </button>
                            <button onclick="goToPage('member-dashboard.html')" class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition">
                                ğŸ‘¤ íšŒì›ëŒ€ì‹œë³´ë“œë¡œ
                            </button>
                        </div>
                    </div>
                    
                    <!-- íšŒì› í†µê³„ -->
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“Š íšŒì› í†µê³„</h3>
                        <div id="member-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-lg text-blue-600">0</div>
                                <div class="text-gray-600">ì¹´ì¹´ì˜¤í†¡</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-green-600">0</div>
                                <div class="text-gray-600">ì´ë©”ì¼</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-purple-600">0</div>
                                <div class="text-gray-600">Firebase</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-orange-600">0</div>
                                <div class="text-gray-600">localStorage</div>
                            </div>
                        </div>
                    </div>

                    <!-- íšŒì› ëª©ë¡ -->
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-green-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">í”„ë¡œí•„</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">íšŒì›ëª…/í¬ì¸íŠ¸</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">ë¡œê·¸ì¸ ë°©ì‹</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">ì´ë©”ì¼</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">íœ´ëŒ€í°</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">ê°€ì…ì¼</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">ì—…ë°ì´íŠ¸</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">ë°ì´í„° ì†ŒìŠ¤</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="members-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- í›„ê¸° ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="reviews-section" class="section-content p-8 hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">â­ í›„ê¸° ê´€ë¦¬</h2>
                        <div class="flex gap-2">
                            <button onclick="initializeReviewsData()" class="px-4 py-2 bg-purple-500 text-white rounded-lg font-semibold hover:bg-purple-600 transition">
                                ğŸš€ ì´ˆê¸° í›„ê¸° ë°ì´í„° ìƒì„±
                            </button>
                            <button onclick="addNewReview()" class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition">
                                â• ìƒˆ í›„ê¸° ì¶”ê°€
                            </button>
                            <button onclick="goToPage('reviews.html')" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
                                ğŸ‘ï¸ í›„ê¸° í˜ì´ì§€ ë³´ê¸°
                            </button>
                        </div>
                    </div>
                    
                    <!-- í›„ê¸° í†µê³„ -->
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“Š í›„ê¸° í†µê³„</h3>
                        <div id="review-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-lg text-blue-600">0</div>
                                <div class="text-gray-600">ì´ í›„ê¸°</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-green-600">0</div>
                                <div class="text-gray-600">ìŠ¹ì¸ëœ í›„ê¸°</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-yellow-600">0</div>
                                <div class="text-gray-600">ëŒ€ê¸° ì¤‘</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-lg text-red-600">0</div>
                                <div class="text-gray-600">ê±°ë¶€ëœ í›„ê¸°</div>
                            </div>
                        </div>
                    </div>

                    <!-- í•„í„° ë° ê²€ìƒ‰ -->
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
                            <div class="w-full md:w-1/3">
                                <input type="text" id="review-search" placeholder="ìƒí’ˆëª…ì´ë‚˜ ì‘ì„±ìë¡œ ê²€ìƒ‰..." 
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div class="flex gap-2">
                                <select id="review-status-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="">ì „ì²´ ìƒíƒœ</option>
                                    <option value="approved">ìŠ¹ì¸ë¨</option>
                                    <option value="pending">ëŒ€ê¸° ì¤‘</option>
                                    <option value="rejected">ê±°ë¶€ë¨</option>
                                </select>
                                <select id="review-category-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                                    <option value="ì „ìì œí’ˆ">ì „ìì œí’ˆ</option>
                                    <option value="ì˜ë¥˜">ì˜ë¥˜</option>
                                    <option value="í™”ì¥í’ˆ">í™”ì¥í’ˆ</option>
                                    <option value="ìƒí™œìš©í’ˆ">ìƒí™œìš©í’ˆ</option>
                                    <option value="ì‹í’ˆ">ì‹í’ˆ</option>
                                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- í›„ê¸° ëª©ë¡ -->
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-yellow-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">í”„ë¡œí•„</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ì‘ì„±ì</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ìƒí’ˆëª…</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ì ˆì•½ê¸ˆì•¡</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ë³„ì </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ìƒíƒœ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ì‘ì„±ì¼</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-yellow-700 uppercase tracking-wider">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="reviews-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì‚¬ìš©ì ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div id="user-detail-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="user-detail-modal-title">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto relative">
            <button id="close-user-detail" class="absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl" aria-label="ì‚¬ìš©ì ìƒì„¸ë³´ê¸° ë‹«ê¸°">&times;</button>
            <h2 id="user-detail-modal-title" class="text-2xl font-bold text-center mb-6 text-gray-700">ğŸ‘¤ íšŒì› ìƒì„¸ì •ë³´</h2>
            
            <div id="user-detail-content" class="space-y-6">
                <!-- ì‚¬ìš©ì ì •ë³´ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
            </div>
            
            <div class="mt-6 flex justify-end gap-3">
                <button id="edit-user-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition">
                    âœï¸ ì •ë³´ ìˆ˜ì •
                </button>
                <button id="delete-user-btn" class="px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition">
                    ğŸ—‘ï¸ íšŒì› ì‚­ì œ
                </button>
                <button id="close-user-detail-btn" class="px-4 py-2 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition">
                    ë‹«ê¸°
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì‚¬ì´ë“œë°” í´ë¦­ ì´ë²¤íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    switchSection(section);
                });
            });
        });
    </script>
</body>
</html>
