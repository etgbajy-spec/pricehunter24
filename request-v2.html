<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PriceHunter - ìµœì €ê°€ ê²€ì¦ ì˜ë¢°</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-N7R437NT77"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N7R437NT77');
  </script>
  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Firebase v9 SDK (ëª¨ë“ˆì‹) -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import { getAuth } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
    import { getFirestore, collection, addDoc, serverTimestamp, getDocs, query, where, orderBy, doc, updateDoc, deleteDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';
    
    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyDBZxKyMS7eeBTbPnbZkj0WWOZQHNldoL4",
      authDomain: "pricehunter-99a1b.firebaseapp.com",
      projectId: "pricehunter-99a1b",
      storageBucket: "pricehunter-99a1b.firebasestorage.app",
      messagingSenderId: "242265693919",
      appId: "1:242265693919:web:74234d942b82a51541136a",
      measurementId: "G-4BKLV4EVB9"
    };

    // Firebase ì´ˆê¸°í™”
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // ì „ì—­ ë³€ìˆ˜ë¡œ ë…¸ì¶œ
    window.firebaseApp = app;
    window.firebaseAuth = auth;
    window.firebaseDb = db;
    window.firebaseFirestoreFunctions = { 
      collection, 
      addDoc, 
      serverTimestamp, 
      query, 
      orderBy, 
      getDocs, 
      where, 
      doc, 
      updateDoc, 
      deleteDoc 
    };

    console.log('âœ… Firebase v9 ì´ˆê¸°í™” ì™„ë£Œ (request-v2.html)');
  </script>
  
  <style>
    /* í…ìŠ¤íŠ¸ ì„ íƒ í—ˆìš© (ë“œë˜ê·¸ ê°€ëŠ¥) */
    body {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
    
    /* ë²„íŠ¼ê³¼ ë§í¬, ì…ë ¥ í•„ë“œëŠ” í…ìŠ¤íŠ¸ ì„ íƒ í—ˆìš© */
    button, a, input, textarea, select {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
    
    /* ì»¤ì„œ ê¹œë¹¡ì„ ë°©ì§€ */
    body, div, p, h1, h2, h3, h4, h5, h6, span, label {
      caret-color: transparent;
    }
    
    /* ì…ë ¥ ìš”ì†ŒëŠ” ì»¤ì„œ í‘œì‹œ */
    input, textarea {
      caret-color: auto;
    }
    .fadein-step {
      animation: fadein-step 0.7s cubic-bezier(.4,0,.2,1) both;
    }
    @keyframes fadein-step {
      0% { opacity: 0; transform: translateY(40px) scale(0.98); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    .slidein-step {
      animation: slidein-step 0.7s cubic-bezier(.4,0,.2,1) both;
    }
    @keyframes slidein-step {
      0% { opacity: 0; transform: translateX(60px) scale(0.98); }
      100% { opacity: 1; transform: translateX(0) scale(1); }
    }
    .stepper-dot-animate {
      transition: background 0.4s, box-shadow 0.4s, transform 0.4s;
    }
    .stepper-dot-active {
      background: linear-gradient(90deg, #f472b6 0%, #fbbf24 100%);
      box-shadow: 0 4px 16px 0 rgba(255, 99, 132, 0.15);
      transform: scale(1.15);
    }
    .stepper-dot {
      background: #d1d5db;
    }
    .input-animate:focus {
      box-shadow: 0 0 0 3px #fbbf24aa;
      transition: box-shadow 0.3s;
    }
    .btn-animate {
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn-animate:hover {
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 8px 32px 0 rgba(236, 72, 153, 0.12);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-100 via-blue-50 to-emerald-50 min-h-screen flex flex-col items-center justify-center py-4 md:py-12">
  <div class="w-full max-w-lg bg-white/90 rounded-2xl shadow-2xl p-4 md:p-8 lg:p-10 backdrop-blur-md">
    <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-blue-800 mb-4 md:mb-6 text-center">ìµœì €ê°€<br class="sm:hidden">ìš”ì²­í•˜ê¸°</h2>
    <div id="stepper" class="flex justify-between items-center mb-6 md:mb-8">
      <div class="flex-1 flex flex-col items-center">
        <div class="w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center font-bold text-white stepper-dot stepper-dot-animate text-sm md:text-base" id="step-1-dot">1</div>
        <div class="text-xs mt-1 hidden sm:block">ì˜ë¢°<br class="sm:hidden">ë“±ë¡</div>
      </div>
      <div class="flex-1 h-1 bg-gradient-to-r from-blue-300 to-pink-300 mx-1"></div>
      <div class="flex-1 flex flex-col items-center">
        <div class="w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center font-bold text-white stepper-dot stepper-dot-animate text-sm md:text-base" id="step-2-dot">2</div>
        <div class="text-xs mt-1 hidden sm:block">ì°¸ê³ /<br class="sm:hidden">ì´ë¯¸ì§€</div>
      </div>
      <div class="flex-1 h-1 bg-gradient-to-r from-blue-300 to-pink-300 mx-1"></div>
      <div class="flex-1 flex flex-col items-center">
        <div class="w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center font-bold text-white stepper-dot stepper-dot-animate text-sm md:text-base" id="step-3-dot">3</div>
        <div class="text-xs mt-1 hidden sm:block">ì—°ë½ì²˜</div>
      </div>
      <div class="flex-1 h-1 bg-gradient-to-r from-blue-300 to-pink-300 mx-1"></div>
      <div class="flex-1 flex flex-col items-center">
        <div class="w-8 h-8 md:w-10 md:h-10 rounded-full flex items-center justify-center font-bold text-white stepper-dot stepper-dot-animate text-sm md:text-base" id="step-4-dot">4</div>
        <div class="text-xs mt-1 hidden sm:block">ì ‘ìˆ˜ì™„ë£Œ</div>
      </div>
    </div>
    <form id="step-form">
      <!-- Step 1: ì œí’ˆì •ë³´ -->
      <div class="step" id="step-1">
        <div class="mb-4 p-3 rounded-xl bg-blue-50 border border-blue-200 text-blue-800 text-base font-semibold text-center shadow-sm animate-fadein-up">
          ğŸ“ <span class="font-bold">ìµœì €ê°€ ìš”ì²­ ë“±ë¡</span><br>
          <span class="text-pink-600 font-bold">âš ï¸ ë¸Œëœë“œ ì œí’ˆì€ ê²€ì¦ ì œì™¸ë©ë‹ˆë‹¤</span><br>
          <span class="text-xs text-gray-600">ì• í”Œ, ì‚¼ì„±, LG, ëª…í’ˆ, ìŠ¤ë‹ˆì»¤ì¦ˆ, ëŒ€í˜•TV ë“± ë¸Œëœë“œ ì œí’ˆì€<br>ê°€ê²© ë³€ë™ì´ ì‹¬í•˜ê³  ì •í™•í•œ ë¹„êµê°€ ì–´ë ¤ì›Œ ê²€ì¦ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤</span><br>
          <span class="block mt-2 text-blue-700">ì˜ˆì‹œ: "ìº í•‘ìš© ì ‘ì´ì‹ ì˜ì, 4ì¸ìš©, ë°©ìˆ˜ì²œ, ë“±ë°›ì´ ì¡°ì ˆ ê°€ëŠ¥"</span>
          <div class="mt-3">
            <a href="support.html#faq" class="inline-block px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors">
              ğŸ“‹ ìì„¸í•œ ë‚´ìš©ì€ êµ¬ë§¤ì „í•„ë…ì‚¬í•­
            </a>
          </div>
        </div>
        <label class="block text-gray-700 font-semibold mb-2" for="productName">ì œí’ˆëª…</label>
        <input type="text" id="productName" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:outline-none transition mb-4 input-animate" placeholder="ì˜ˆ: ìº í•‘ìš© ì ‘ì´ì‹ ì˜ì, ì±…ìƒ, ì˜·ì¥, ì£¼ë°©ìš©í’ˆ ë“±" />
        <div class="text-xs text-blue-500 mt-1">ğŸ’¡ ë¸Œëœë“œê°€ ì—†ëŠ” ì œí’ˆ, ë˜ëŠ” ë¸Œëœë“œê°€ ì¤‘ìš”í•˜ì§€ ì•Šì€ ì œí’ˆ ìœ„ì£¼ë¡œ ì˜ë¢°í•´ ì£¼ì„¸ìš”!</div>
        <label class="block text-gray-700 font-semibold mb-2" for="productDesc">ì œí’ˆ ì„¤ëª… <span class="text-sm text-blue-600 font-normal">(ì œí’ˆì˜ í•µì‹¬í¬ì¸íŠ¸)</span></label>
        <textarea id="productDesc" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:outline-none transition mb-4 input-animate" rows="3" placeholder="ì˜ˆ: 4ì¸ìš©, ë°©ìˆ˜ì²œ, ë“±ë°›ì´ ì¡°ì ˆ, ì ‘ì´ì‹, íœ´ëŒ€ìš©, ìµœëŒ€ í•˜ì¤‘ 120kg, ìƒ‰ìƒ: ë„¤ì´ë¹„ / 3ë‹¨, ì² ì œ í”„ë ˆì„, ì˜·ê±¸ì´ í¬í•¨, ì¡°ë¦½ì‹, ìƒ‰ìƒ: í™”ì´íŠ¸ ë“±"></textarea>
        <label class="block text-gray-700 font-semibold mb-2" for="productPrice">ì˜ˆìƒ ê°€ê²©(ì›)</label>
        <input type="number" id="productPrice" min="1000" step="1" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:outline-none transition mb-2 input-animate" placeholder="ì˜ˆ: 1000 (ì›)" />
        <div class="text-xs text-pink-600 mb-4">â€» ìµœì†Œ ì˜ë¢° ê¸ˆì•¡ì€ <span class="font-bold">1,000ì›</span> ì´ìƒì…ë‹ˆë‹¤.</div>
        
        <!-- ë¹„êµ ì˜µì…˜ -->
        <div class="bg-gray-50 p-4 rounded-lg mb-4">
          <h4 class="font-semibold text-gray-800 mb-3">ë¹„êµ ì˜µì…˜</h4>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="radio" name="comparisonType" value="exact" checked class="mr-2 text-blue-600">
              <span class="text-sm">â–¢ ì™„ì „ ë™ì¼ë§Œ ë¹„êµ (ê¸°ë³¸)</span>
            </label>
            <label class="flex items-center">
              <input type="radio" name="comparisonType" value="flexible" class="mr-2 text-blue-600">
              <span class="text-sm">â–¢ ìƒ‰ìƒÂ·íŒ¨í‚¤ì§• ë¬´ê´€ í—ˆìš©</span>
            </label>
          </div>
        </div>
        
        <!-- ë§ˆì´í¬ë¡œì¹´í”¼ -->
        <div class="bg-blue-50 p-3 rounded-lg mb-4">
          <p class="text-sm text-blue-800 font-medium">ğŸ’¡ ê³ ê°ë‹˜ì´ ì˜ë¢°í•˜ì‹  ì œí’ˆë³´ë‹¤ ë” ì €ë ´í•œ ìµœì €ê°€ë¥¼ ì°¾ì•„ë“œë¦¬ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤!</p>
        </div>
        
        <!-- ë™ì˜ ì²´í¬ë°•ìŠ¤ -->
        <div class="space-y-3 mb-4">
          <div class="flex items-start">
            <input type="checkbox" id="evidenceAgree" required class="mt-1 mr-2 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-400">
            <label for="evidenceAgree" class="text-sm text-gray-700">[í•„ìˆ˜] ì¦ê±° ìˆ˜ì§‘(ë§í¬/ìŠ¤í¬ë¦°ìƒ·)Â·ì‹œì ê³ ì • ì•ˆë‚´ì— ë™ì˜í•©ë‹ˆë‹¤.</label>
          </div>
          <div class="flex items-start">
            <input type="checkbox" id="brandExcludeAgree" required class="mt-1 mr-2 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-400">
            <label for="brandExcludeAgree" class="text-sm text-gray-700">[í•„ìˆ˜] ë¸Œëœë“œë°°ì œ ì •ì±…(ì• í”ŒÂ·ëª…í’ˆÂ·ìŠ¤ë‹ˆì»¤ì¦ˆÂ·ëŒ€í˜•TV ë“±)ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.</label>
          </div>
        </div>
        <button type="button" class="w-full mt-8 py-3 bg-blue-500 text-white font-bold rounded-lg shadow btn-animate" id="to-step-2">ë‹¤ìŒ</button>
      </div>
      <!-- Step 2: ì°¸ê³ /ì´ë¯¸ì§€ -->
      <div class="step hidden" id="step-2">
        <div class="mb-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200 text-emerald-800 text-base font-semibold text-center shadow-sm animate-fadein-up">
          ğŸ”— <span class="font-bold">ì°¸ê³ í•  ë§Œí•œ ì‚¬ì´íŠ¸(ì‡¼í•‘ëª°, ë¸”ë¡œê·¸ ë“±) ë§í¬ë¥¼ ë‚¨ê²¨ì£¼ì‹œë©´<br>ë” ì •í™•í•˜ê²Œ ì›í•˜ëŠ” ì œí’ˆì„ íŒŒì•…í•  ìˆ˜ ìˆì–´ìš”!</span><br>
          ê³µì‹ ì‡¼í•‘ëª°, ê°€ê²©ë¹„êµ ì‚¬ì´íŠ¸, ë¸”ë¡œê·¸ í›„ê¸° ë“± ì–´ë–¤ ë§í¬ë“  ê´œì°®ì•„ìš”.<br>
          <span class="text-pink-600 font-bold">ë§í¬ëŠ” 1ê°œë§Œ ì…ë ¥í•´ ì£¼ì„¸ìš”.</span><br>
          <span class="text-xs text-gray-500">ğŸ’¡ ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 5ì¥ê¹Œì§€ ì²¨ë¶€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ì œí’ˆì˜ ì‹¤ì œ ì‚¬ì§„, ìº¡ì²˜, ì„¤ëª…ì„œ ë“± ì–´ë–¤ ì´ë¯¸ì§€ë“  ë„ì›€ì´ ë©ë‹ˆë‹¤!</span>
        </div>
        <label class="block text-gray-700 font-semibold mb-2" for="productUrl">ì°¸ê³ ì‚¬ì´íŠ¸(ë§í¬ 1ê°œ) <span class="text-red-500">*</span></label>
        <input type="text" id="productUrl" name="productUrl" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-amber-400 focus:outline-none transition" placeholder="ì˜ˆ: https://example.com ë˜ëŠ” www.example.com" />
        <div class="text-xs text-emerald-500 mt-1">ğŸ’¡ http://, https://, www.ë¡œ ì‹œì‘í•˜ëŠ” ë§í¬ë§Œ ì…ë ¥í•´ ì£¼ì„¸ìš”.</div>
        <label class="block text-gray-700 font-semibold mb-2 mt-6" for="productImage">ì œí’ˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ (ìµœëŒ€ 5ì¥)</label>
        <input type="file" id="productImage" name="productImage" accept="image/*" class="w-full" multiple />
        <div id="imagePreview" class="mt-2 flex flex-wrap gap-2"></div>
        <div class="text-xs text-emerald-500 mt-1">ğŸ’¡ ì—¬ëŸ¬ ì¥ ì²¨ë¶€ ì‹œ, ì²« ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ ëŒ€í‘œ ì´ë¯¸ì§€ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</div>
        <button type="button" class="w-full mt-8 py-3 bg-blue-500 text-white font-bold rounded-lg shadow btn-animate" id="to-step-3">ë‹¤ìŒ</button>
        <button type="button" class="w-full mt-2 py-2 bg-gray-200 text-gray-700 rounded-lg shadow btn-animate" id="back-step-1">ì´ì „</button>
      </div>
      <!-- Step 3: ì—°ë½ì²˜/ì´ë¦„/í†µê´€ë²ˆí˜¸ -->
      <div class="step hidden" id="step-3">
        <div class="mb-4 p-3 rounded-xl bg-yellow-50 border border-yellow-200 text-yellow-800 text-base font-semibold text-center shadow-sm animate-fadein-up">
          ğŸ“ <span class="font-bold">ì—°ë½ ê°€ëŠ¥í•œ ì •ë³´ë¥¼ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”!</span><br>
          ì…ë ¥í•˜ì‹  ì •ë³´ë¡œ ìµœì €ê°€ ì•ˆë‚´ ë° ì¶”ê°€ ë¬¸ì˜ë¥¼ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          <span class="text-pink-600 font-bold">ì´ë¦„ì€ â€œíšŒì›ê°€ì… ì‹œ ì…ë ¥í•œ ì´ë¦„â€ê³¼ ë°˜ë“œì‹œ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.</span><br>
          ì „í™”ë²ˆí˜¸, ì´ë©”ì¼, í†µê´€ê³ ìœ ë¶€í˜¸(í•„ìš”ì‹œ) ë“±ì€ ì‹¤ì œë¡œ ì—°ë½ ê°€ëŠ¥í•œ ì •ë³´ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”.<br>
          <span class="text-xs text-gray-500">ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ì˜¤ì§ ì˜ë¢° ì²˜ë¦¬ì™€ ì•ˆë‚´ë¥¼ ìœ„í•´ì„œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.</span>
        </div>
        <label class="block text-gray-700 font-semibold mb-2" for="userName">ì´ë¦„</label>
        <input type="text" id="userName" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-yellow-400 focus:outline-none transition mb-2 input-animate" placeholder="íšŒì›ê°€ì… ì‹œ ì…ë ¥í•œ ì´ë¦„" />
        <div class="text-xs text-yellow-600 mt-1">ğŸ’¡ íšŒì›ê°€ì… ì‹œ ì…ë ¥í•œ ì´ë¦„ê³¼ ë‹¤ë¥´ë©´ ì˜ë¢°ê°€ ì ‘ìˆ˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
        <label class="block text-gray-700 font-semibold mb-2 mt-4" for="userPhone">ì „í™”ë²ˆí˜¸</label>
        <input type="tel" id="userPhone" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-yellow-400 focus:outline-none transition mb-2 input-animate" placeholder="ì˜ˆ: 01012345678" />
        <div class="text-xs text-yellow-600 mt-1">ğŸ“± ì •í™•í•œ ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”. ì•ˆë‚´ ë° ë¬¸ì˜ì— ê¼­ í•„ìš”í•©ë‹ˆë‹¤.</div>

        <label class="block text-gray-700 font-semibold mb-2 mt-4" for="userEmail">ì´ë©”ì¼</label>
        <input type="email" id="userEmail" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-yellow-400 focus:outline-none transition mb-2 input-animate" placeholder="ì˜ˆ: user@email.com" />
        <div class="text-xs text-yellow-600 mt-1">ğŸ“§ ì •í™•í•œ ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”. ì•ˆë‚´ ë° ë¬¸ì˜ì— ê¼­ í•„ìš”í•©ë‹ˆë‹¤.</div>
        <button type="button" class="w-full mt-8 py-3 bg-blue-500 text-white font-bold rounded-lg shadow btn-animate" id="to-step-4">ë‹¤ìŒ</button>
        <button type="button" class="w-full mt-2 py-2 bg-gray-200 text-gray-700 rounded-lg shadow btn-animate" id="back-step-2">ì´ì „</button>
      </div>
      <!-- Step 4: í™•ì¸ ë° ì œì¶œ -->
      <div class="step hidden" id="step-4">
        <div class="mb-4 p-3 rounded-xl bg-gray-50 border border-gray-200 text-gray-800 text-base font-semibold text-center shadow-sm animate-fadein-up">
          âœ… <span class="font-bold">ì…ë ¥í•˜ì‹  ë‚´ìš©ì„ ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•´ ì£¼ì„¸ìš”!</span><br>
          ì œì¶œ í›„ì—ëŠ” ìˆ˜ì •ì´ ì–´ë ¤ìš°ë‹ˆ, ëª¨ë“  ì •ë³´ê°€ ì •í™•í•œì§€ ê¼­ í™•ì¸í•´ ì£¼ì„¸ìš”.<br>
          <span class="text-pink-600 font-bold">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•˜ì…”ì•¼ ì˜ë¢°ê°€ ì™„ë£Œë©ë‹ˆë‹¤.</span><br>
          <span class="text-xs text-gray-500">ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ì˜¤ì§ ì˜ë¢° ì²˜ë¦¬ì™€ ì•ˆë‚´ë¥¼ ìœ„í•´ì„œë§Œ ì•ˆì „í•˜ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤.<br>
          ì˜ë¢°ê°€ ì ‘ìˆ˜ë˜ë©´, ì…ë ¥í•˜ì‹  ì—°ë½ì²˜ë¡œ ì•ˆë‚´ë¥¼ ë“œë¦½ë‹ˆë‹¤.</span>
        </div>
        <div class="bg-blue-50 rounded-xl p-4 mb-4 text-sm text-gray-700" id="confirm-summary"></div>
        <div class="flex items-start mt-2 mb-4">
          <input type="checkbox" id="privacyAgree" required class="mt-1 mr-2 w-5 h-5 text-pink-500 border-gray-300 rounded focus:ring-pink-400" />
          <label for="privacyAgree" class="text-gray-700 text-sm select-none">[í•„ìˆ˜] ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤.</label>
        </div>
        <div class="text-xs text-pink-600 mb-4">ğŸ’¡ ë™ì˜í•˜ì§€ ì•Šìœ¼ì‹œë©´ ì˜ë¢°ê°€ ì ‘ìˆ˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
        <button type="submit" class="w-full py-3 bg-gradient-to-r from-amber-400 to-pink-500 text-white font-bold rounded-lg shadow-lg btn-animate text-lg" id="submit-btn">ìµœì €ê°€ ìš”ì²­ ì œì¶œí•˜ê¸°</button>
        <button type="button" class="w-full mt-2 py-2 bg-gray-200 text-gray-700 rounded-lg shadow btn-animate" id="back-step-3">ì´ì „</button>
      </div>
    </form>
    <div id="submit-success" class="hidden mt-6 space-y-6">
      <!-- ì ‘ìˆ˜ ì™„ë£Œ ë©”ì‹œì§€ -->
      <div class="p-6 bg-emerald-50 border border-emerald-200 rounded-xl text-emerald-700 text-center">
        <div class="text-2xl mb-2">âœ…</div>
        <h3 class="text-xl font-bold mb-2">ì˜ë¢°ê°€ ì •ìƒì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
        <p class="text-sm">ê²€ì¦ ë¦¬í¬íŠ¸ëŠ” 24-48ì‹œê°„ ë‚´ ì „ë‹¬ë©ë‹ˆë‹¤.</p>
      </div>
      
      <!-- í˜„ì¬ ê³µê°œ ë§ˆì¼“ ìŠ¤ëƒ…ìƒ· -->
      <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
        <h4 class="font-semibold text-blue-800 mb-2">ğŸ“Š í˜„ì¬ ê³µê°œ ë§ˆì¼“ í‘œë©´ìµœì €ê°€</h4>
        <div class="text-sm text-blue-700">
          <p>â€¢ ì¿ í° ë¯¸ì ìš© ê¸°ì¤€ ëŒ€ëµì¹˜</p>
          <p>â€¢ ì •í™•í•œ ê²€ì¦ ê²°ê³¼ëŠ” ë³„ë„ ì•ˆë‚´</p>
        </div>
      </div>
      
      <!-- ì ˆê°ì™• ì‚¬ë¡€ ì¸ë„¤ì¼ -->
      <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <h4 class="font-semibold text-yellow-800 mb-2">ğŸ† ì´ë²ˆ ì£¼ ì ˆê°ì™• ì‚¬ë¡€</h4>
        <div class="flex items-center gap-3">
          <img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=80&q=80" 
               alt="ì ˆê°ì™•" class="w-16 h-16 object-cover rounded-lg">
          <div class="flex-1">
            <p class="font-semibold text-sm">ì „ê¸°í¬íŠ¸ 3ë§Œ8ì²œì› ì ˆê°</p>
            <p class="text-xs text-gray-600">-42% ì ˆê° | ê¹€OO, 30ëŒ€ ì§ì¥ì¸</p>
          </div>
          <a href="savings-king.html" class="text-xs bg-yellow-600 text-white px-2 py-1 rounded hover:bg-yellow-700 transition">
            ë”ë³´ê¸°
          </a>
        </div>
      </div>
    </div>
  </div>
  <script>
    // ìŠ¤í… ê´€ë¦¬
    let currentStep = 1;
    const steps = [1,2,3,4];
    function showStep(n) {
      console.log(`showStep(${n}) í˜¸ì¶œë¨`);
      steps.forEach(s => {
        const el = document.getElementById(`step-${s}`);
        if (el) {
          el.classList.toggle('hidden', s !== n);
          console.log(`Step ${s} ìš”ì†Œ:`, el.classList.contains('hidden') ? 'ìˆ¨ê¹€' : 'í‘œì‹œ');
        }
        const dot = document.getElementById(`step-${s}-dot`);
        if (dot) {
          dot.className = `w-10 h-10 rounded-full flex items-center justify-center font-bold text-white stepper-dot stepper-dot-animate${s === n ? ' stepper-dot-active' : ''}`;
        }
        if (s === n) {
          el.classList.remove('slidein-step','fadein-step');
          el.classList.add('fadein-step');
        } else {
          el.classList.remove('fadein-step');
        }
      });
      currentStep = n;
      console.log(`í˜„ì¬ ë‹¨ê³„: ${currentStep}`);
    }
    showStep(1);
    // ìŠ¤í… ì´ë™ ë²„íŠ¼
    document.getElementById('to-step-2').onclick = function() {
      console.log('ë‹¤ìŒ ë²„íŠ¼ í´ë¦­ë¨');
      // Step 1 ìœ íš¨ì„±
      if (!document.getElementById('productName').value.trim() || !document.getElementById('productDesc').value.trim()) {
        alert('ì œí’ˆëª…ê³¼ ì„¤ëª…ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
        return;
      }
      const price = Number(document.getElementById('productPrice').value);
      if (isNaN(price) || price < 1000) {
        alert('ìµœì†Œ ì˜ë¢° ê¸ˆì•¡ì€ 1,000ì› ì´ìƒì…ë‹ˆë‹¤. ë” ì €ë ´í•œ ì œí’ˆì€ ì˜ë¢°ê°€ ì–´ë µìŠµë‹ˆë‹¤.');
        return;
      }
      if (!document.getElementById('brandExcludeAgree').checked) {
        alert('ë¸Œëœë“œ ë°°ì œ ì •ì±…ì— ë™ì˜í•´ ì£¼ì„¸ìš”.');
        return;
      }
      console.log('ìœ íš¨ì„± ê²€ì‚¬ í†µê³¼, showStep(2) í˜¸ì¶œ');
      showStep(2);
    };
    document.getElementById('to-step-3').onclick = function() {
      // Step 2 ìœ íš¨ì„±: ì°¸ê³ ì‚¬ì´íŠ¸ í•„ìˆ˜ ì…ë ¥
      const url = document.getElementById('productUrl').value.trim();
      if (!url) {
        alert('ì°¸ê³ ì‚¬ì´íŠ¸ ë§í¬ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
        return;
      }
      const urlPattern = /^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)$/;
      if (!urlPattern.test(url)) {
        alert('ì°¸ê³ ì‚¬ì´íŠ¸ëŠ” http://, https://, ë˜ëŠ” www.ë¡œ ì‹œì‘í•˜ëŠ” ì˜¬ë°”ë¥¸ ë§í¬ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
        return;
      }
      showStep(3);
    };
    document.getElementById('to-step-4').onclick = async function() {
      // Step 3 ìœ íš¨ì„±
      if (!document.getElementById('userName').value.trim() || !document.getElementById('userPhone').value.trim() || !document.getElementById('userEmail').value.trim()) {
        alert('ì—°ë½ì²˜ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
        return;
      }
      // ì´ë¦„ ì¼ì¹˜ ê²€ì¦ (Firebaseì—ì„œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°)
      let user = null;
      try {
        await waitForFirebase();
        const { collection, query, where, getDocs } = window.firebaseFirestoreFunctions;
        const db = window.firebaseDb;
        
        const loggedInEmail = localStorage.getItem('loggedInEmail');
        if (loggedInEmail) {
          const usersRef = collection(db, 'users');
          const q = query(usersRef, where('email', '==', loggedInEmail));
          const querySnapshot = await getDocs(q);
          
          if (!querySnapshot.empty) {
            user = querySnapshot.docs[0].data();
          }
        }
      } catch (error) {
        console.error('ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', error);
      }
      
      const userName = document.getElementById('userName').value.trim();
      if (!user || !user.name || user.name.trim() !== userName) {
        alert('íšŒì›ê°€ì… ì‹œ ì…ë ¥í•œ ì´ë¦„ê³¼ ë™ì¼í•˜ê²Œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');
        return;
      }
      renderConfirmSummary();
      showStep(4);
    };
    document.getElementById('back-step-1').onclick = function() { showStep(1); };
    document.getElementById('back-step-2').onclick = function() { showStep(2); };
    document.getElementById('back-step-3').onclick = function() { showStep(3); };
    // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë° ìµœëŒ€ 5ì¥ ì œí•œ
    const imageInput = document.getElementById('productImage');
    const imagePreview = document.getElementById('imagePreview');
    let imageFiles = [];
    if (imageInput) {
      imageInput.addEventListener('change', function(event) {
        const files = Array.from(event.target.files);
        if (files.length + imageFiles.length > 5) {
          alert('ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 5ì¥ê¹Œì§€ ì²¨ë¶€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
          imageInput.value = '';
          return;
        }
        files.forEach(file => {
          if (imageFiles.length < 5) {
            imageFiles.push(file);
          }
        });
        renderImagePreview();
        imageInput.value = '';
      });
    }
    function renderImagePreview() {
      imagePreview.innerHTML = '';
      imageFiles.forEach((file, idx) => {
        const reader = new FileReader();
        reader.onload = function(e) {
          const wrapper = document.createElement('div');
          wrapper.className = 'relative';
          wrapper.innerHTML = `<img src="${e.target.result}" alt="ë¯¸ë¦¬ë³´ê¸°" class="max-h-32 rounded-xl shadow-md border border-gray-200" />` +
            `<button type="button" class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs" data-idx="${idx}">&times;</button>`;
          imagePreview.appendChild(wrapper);
          wrapper.querySelector('button').onclick = function() {
            imageFiles.splice(idx, 1);
            renderImagePreview();
          };
        };
        reader.readAsDataURL(file);
      });
    }
    // Step 4: í™•ì¸ ìš”ì•½ ë Œë”ë§
    function renderConfirmSummary() {
      const productName = document.getElementById('productName').value;
      const productDesc = document.getElementById('productDesc').value;
      const productUrl = document.getElementById('productUrl').value.trim();
      const price = document.getElementById('productPrice').value;
      const summary = `
        <div><span class="font-bold">ì œí’ˆëª…:</span> ${productName}</div>
        <div><span class="font-bold">ì œí’ˆ ì„¤ëª…:</span> ${productDesc}</div>
        <div><span class="font-bold">ì˜ˆìƒ ê°€ê²©:</span> ${price ? price + 'ì›' : '(ë¯¸ì…ë ¥)'}</div>
        <div><span class="font-bold">ì°¸ê³ ì‚¬ì´íŠ¸:</span> ${productUrl ? (/^https?:\/\//.test(productUrl) || /^www\./.test(productUrl) ? `<a href='${productUrl}' target='_blank' class='text-blue-600 underline'>${productUrl}</a>` : `<span class='bg-gray-100 rounded px-2 py-1'>${productUrl}</span>`) : '<span class=\'text-gray-400\'>(ì—†ìŒ)</span>'}</div>
        <div><span class="font-bold">ì´ë¦„:</span> ${document.getElementById('userName').value}</div>
        <div><span class="font-bold">ì „í™”ë²ˆí˜¸:</span> ${document.getElementById('userPhone').value}</div>

        <div><span class="font-bold">ì´ë©”ì¼:</span> ${document.getElementById('userEmail').value}</div>
        <div><span class="font-bold">ì´ë¯¸ì§€:</span> <span id='confirm-images'></span></div>
      `;
      document.getElementById('confirm-summary').innerHTML = summary;
      // ì´ë¯¸ì§€ ì¸ë„¤ì¼ ë Œë”ë§
      const imgWrap = document.getElementById('confirm-images');
      if (imageFiles.length > 0) {
        imageFiles.forEach(file => {
          const reader = new FileReader();
          reader.onload = function(e) {
            const img = document.createElement('img');
            img.src = e.target.result;
            img.className = 'inline-block h-12 w-auto rounded-xl border border-gray-200 shadow-sm align-middle mr-2 mb-1';
            imgWrap.appendChild(img);
          };
          reader.readAsDataURL(file);
        });
      } else {
        imgWrap.innerHTML = '<span class="text-gray-400">(ì—†ìŒ)</span>';
      }
    }
    
    // Firebaseì—ì„œ ì˜ë¢° ìƒíƒœ ì—…ë°ì´íŠ¸
    async function updateRequestStatus(reqNum, newStatus, newDetail, newProgress) {
      try {
        await waitForFirebase();
        const { collection, query, where, getDocs, updateDoc } = window.firebaseFirestoreFunctions;
        const db = window.firebaseDb;
        
        const requestsRef = collection(db, 'requests');
        const q = query(requestsRef, where('requestNumber', '==', reqNum));
        const querySnapshot = await getDocs(q);
        
        if (!querySnapshot.empty) {
          const doc = querySnapshot.docs[0];
          await updateDoc(doc.ref, {
            status: newStatus,
            statusDetail: newDetail,
            progress: newProgress,
            lastUpdated: new Date()
          });
          
          // ìƒíƒœ ë³€ê²½ ì•Œë¦¼ (ë¸Œë¼ìš°ì € ì•Œë¦¼)
          if (Notification.permission === 'granted') {
            new Notification('PriceHunter ì˜ë¢° ìƒíƒœ ì—…ë°ì´íŠ¸', {
              body: `${newStatus}: ${newDetail}`,
              icon: '/favicon.ico'
            });
          }
          
          console.log(`ì˜ë¢° #${reqNum} ìƒíƒœ ì—…ë°ì´íŠ¸:`, newStatus);
          return true;
        }
      } catch (error) {
        console.error('ì˜ë¢° ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
      }
      return false;
    }
    
    // ì œì¶œ
    document.getElementById('step-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      if (!document.getElementById('privacyAgree').checked) {
        alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•˜ì…”ì•¼ ì œì¶œì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return;
      }
      // ì´ë¦„ ì¼ì¹˜ ê²€ì¦ (Firebaseì—ì„œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°)
      let user = null;
      try {
        await waitForFirebase();
        const { collection, query, where, getDocs } = window.firebaseFirestoreFunctions;
        const db = window.firebaseDb;
        
        const loggedInEmail = localStorage.getItem('loggedInEmail');
        if (loggedInEmail) {
          const usersRef = collection(db, 'users');
          const q = query(usersRef, where('email', '==', loggedInEmail));
          const querySnapshot = await getDocs(q);
          
          if (!querySnapshot.empty) {
            user = querySnapshot.docs[0].data();
          }
        }
      } catch (error) {
        console.error('ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', error);
      }
      
      const userName = document.getElementById('userName').value.trim();
      if (!user || !user.name || user.name.trim() !== userName) {
        alert('íšŒì›ê°€ì… ì‹œ ì…ë ¥í•œ ì´ë¦„ê³¼ ë™ì¼í•˜ê²Œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');
        return;
      }
      // ì°¸ê³ ì‚¬ì´íŠ¸ ë‹¨ì¼ ë§í¬ ìœ íš¨ì„± ê²€ì‚¬ (ìµœì¢… ì œì¶œ ì‹œì—ë„)
      const url = document.getElementById('productUrl').value.trim();
      const urlPattern = /^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)$/;
      if (!urlPattern.test(url)) {
        alert('ì°¸ê³ ì‚¬ì´íŠ¸ëŠ” http://, https://, ë˜ëŠ” www.ë¡œ ì‹œì‘í•˜ëŠ” ì˜¬ë°”ë¥¸ ë§í¬ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
        return;
      }
      // ì´ë¯¸ì§€ ì´ ìš©ëŸ‰ ì²´í¬ (5MB ì œí•œ)
      function getTotalImageSize(files) {
        return files.reduce((sum, file) => sum + file.size, 0);
      }
      if (getTotalImageSize(imageFiles) > 5 * 1024 * 1024) {
        alert('ì²¨ë¶€í•œ ì´ë¯¸ì§€ì˜ ì´ ìš©ëŸ‰ì´ 5MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤. ë” ì‘ì€ ì´ë¯¸ì§€ë¡œ ì²¨ë¶€í•´ ì£¼ì„¸ìš”.');
        return;
      }
      // í•˜ë£¨ 10ê±´ ì œí•œ (í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ì™„í™”)
      const today = new Date().toISOString().slice(0,10);
      const userId = user && user.email ? user.email : userName;
      // Firebaseì—ì„œ í•˜ë£¨ ì˜ë¢° ì¹´ìš´íŠ¸ í™•ì¸ (í–¥í›„ êµ¬í˜„)
      const reqCount = 0; // ì„ì‹œë¡œ 0ìœ¼ë¡œ ì„¤ì •
      if (reqCount >= 10) {
        alert('í•˜ë£¨ ìµœëŒ€ 10ê±´ê¹Œì§€ë§Œ ì˜ë¢°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ì´ìš©í•´ ì£¼ì„¸ìš”!');
        return;
      }
      // ì…ë ¥ê°’ ìˆ˜ì§‘
      const name = document.getElementById('productName').value;
      const desc = document.getElementById('productDesc').value;
      const urls = [url]; // ë‹¨ì¼ ë§í¬ë¡œ ì €ì¥
      const email = document.getElementById('userEmail').value;
      const phone = document.getElementById('userPhone').value;
      

      const price = Number(document.getElementById('productPrice').value);
      // ê³ ìœ  ì˜ë¢°ë²ˆí˜¸ ìƒì„±
      function generateReqNum() {
        const now = new Date();
        const y = now.getFullYear();
        const m = String(now.getMonth()+1).padStart(2,'0');
        const d = String(now.getDate()).padStart(2,'0');
        const rand = String(Math.floor(Math.random()*900)+100);
        return `#PH-${y}${m}${d}${rand}`;
      }
      const reqNum = generateReqNum();
      // ì´ë¯¸ì§€ base64 ë°°ì—´ ì €ì¥
      if (imageFiles.length > 0) {
        const imgArr = [];
        let loaded = 0;
        imageFiles.forEach((file, idx) => {
          const reader = new FileReader();
          reader.onload = async function(e2) {
            imgArr[idx] = e2.target.result;
            loaded++;
            if (loaded === imageFiles.length) {
              await saveRequest(imgArr);
            }
          };
          reader.readAsDataURL(file);
        });
      } else {
        await saveRequest([]);
      }
      async function saveRequest(imgArr) {
        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì •ë¦¬ í•¨ìˆ˜ ì œê±°ë¨ - Firebase ì „ìš© ì‚¬ìš©
        
        const reqData = {
          name, 
          desc, 
          urls, 
          images: imgArr, 
          email, 
          phone, 
          price, 
          userName, 
          date: Date.now(),
          reqNum: reqNum,
          status: 'ì ‘ìˆ˜ë¨',
          statusDetail: 'ì˜ë¢°ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ê²€ìƒ‰ì„ ì‹œì‘í•©ë‹ˆë‹¤.',
          estimatedTime: '2-3ì¼ ë‚´ ì™„ë£Œ ì˜ˆì •',
          lastUpdated: Date.now(),
          progress: 10
        };
        
        try {
          // Firebaseì—ë§Œ ì €ì¥ (ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì œê±°)
          
          // Firebaseì— ì €ì¥
          await saveRequestToFirebase(reqData, reqNum);
          
          document.getElementById('submit-success').classList.remove('hidden');
          
          // í¬ì¸íŠ¸ ì§€ê¸‰ (ì˜ë¢° ì ‘ìˆ˜ ì‹œ) - Firebase ì „ìš©
          if (user && user.email) {
            // Firebase í¬ì¸íŠ¸ ì‹œìŠ¤í…œ (í–¥í›„ êµ¬í˜„)
            console.log('Firebase í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ì‚¬ìš© ì˜ˆì •');
          }
          
          setTimeout(() => { window.location.href = 'request-complete.html'; }, 1200);
          // í•˜ë£¨ ì˜ë¢° ì¹´ìš´íŠ¸ ì¦ê°€ (Firebaseì— ì €ì¥ ì˜ˆì •)
          console.log('ì˜ë¢° ì¹´ìš´íŠ¸ ì¦ê°€:', reqCount + 1);
        } catch (error) {
          console.error('ì˜ë¢° ì €ì¥ ì‹¤íŒ¨:', error);
          alert('ì˜ë¢° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì •ë¦¬í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }
      }
    });
    
    // Firebaseì— ì˜ë¢° ë°ì´í„° ì €ì¥
    async function saveRequestToFirebase(reqData, reqNum) {
      try {
        // Firebase ì´ˆê¸°í™” ëŒ€ê¸°
        await waitForFirebase();
        
        const { collection, addDoc, serverTimestamp } = window.firebaseFirestoreFunctions;
        const db = window.firebaseDb;
        
        // Firebaseì— ì €ì¥í•  ë°ì´í„° ì¤€ë¹„
        const firebaseData = {
          ...reqData,
          requestNumber: reqNum,
          createdAt: serverTimestamp(),
          status: 'pending',
          source: 'web_form'
        };
        
        // Firebaseì— ì €ì¥
        const docRef = await addDoc(collection(db, 'requests'), firebaseData);
        console.log('âœ… Firebaseì— ì˜ë¢° ë°ì´í„° ì €ì¥ ì™„ë£Œ:', docRef.id);
        
        return docRef.id;
      } catch (error) {
        console.error('âŒ Firebaseì— ì˜ë¢° ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
        throw error;
      }
    }
    
    // Firebase ì´ˆê¸°í™” ëŒ€ê¸° í•¨ìˆ˜
    async function waitForFirebase() {
      return new Promise((resolve, reject) => {
        if (window.firebaseApp && window.firebaseDb) {
          resolve();
        } else {
          // Firebase ì´ˆê¸°í™” ëŒ€ê¸°
          const checkInterval = setInterval(() => {
            if (window.firebaseApp && window.firebaseDb) {
              clearInterval(checkInterval);
              resolve();
            }
          }, 100);
          
          // 5ì´ˆ í›„ íƒ€ì„ì•„ì›ƒ
          setTimeout(() => {
            clearInterval(checkInterval);
            reject(new Error('Firebase ì´ˆê¸°í™” íƒ€ì„ì•„ì›ƒ'));
          }, 5000);
        }
      });
    }
    
    // ì´ë©”ì¼ ì…ë ¥ë€ ìë™ ì±„ìš°ê¸° ë° ì½ê¸°ì „ìš© ì²˜ë¦¬
    window.addEventListener('DOMContentLoaded', function() {
      // Firebaseì—ì„œ ì‚¬ìš©ì ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      let user = null;
      let loggedIn = false;
      
      try {
        const loggedInEmail = localStorage.getItem('loggedInEmail');
        if (loggedInEmail) {
          loggedIn = true;
          // Firebaseì—ì„œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ë¹„ë™ê¸°)
          waitForFirebase().then(async () => {
            const { collection, query, where, getDocs } = window.firebaseFirestoreFunctions;
            const db = window.firebaseDb;
            
            const usersRef = collection(db, 'users');
            const q = query(usersRef, where('email', '==', loggedInEmail));
            const querySnapshot = await getDocs(q);
            
            if (!querySnapshot.empty) {
              user = querySnapshot.docs[0].data();
              // ì‚¬ìš©ì ì •ë³´ë¡œ í¼ ìë™ ì±„ìš°ê¸°
              if (user.email) {
                emailInput.value = user.email;
              }
              if (user.name) {
                nameInput.value = user.name;
              }
            }
          });
        }
      } catch (error) {
        console.error('ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', error);
      }
      var emailInput = document.getElementById('userEmail');
      var nameInput = document.getElementById('userName');
      
      if (emailInput && user && user.email && loggedIn) {
        emailInput.value = user.email;
        emailInput.readOnly = true;
      }
      
      if (nameInput && user && user.name) {
        nameInput.value = user.name;
        emailInput.classList.add('bg-gray-100','cursor-not-allowed');
      }
    });
  </script>
</body>
</html> 